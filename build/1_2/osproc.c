/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY62202 TY62202;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY4377 TY4377;
typedef struct TY10602 TY10602;
typedef struct TY8004 TY8004;
typedef struct TY10990 TY10990;
typedef struct TY10618 TY10618;
typedef struct TY10614 TY10614;
typedef struct TY10610 TY10610;
typedef struct TY10988 TY10988;
typedef struct TY62701 TY62701;
typedef struct TY61027 TY61027;
typedef struct TY63204 TY63204;
typedef struct TY60408 TY60408;
typedef struct TY40006 TY40006;
typedef struct TY40004 TY40004;
typedef struct TY27432 TY27432;
typedef struct TY27434 TY27434;
typedef struct TY27436 TY27436;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY62202 {
  TNimObject Sup;
NI Fprocesshandle;
NI32 Inputhandle;
NI32 Outputhandle;
NI32 Errorhandle;
NI32 Id;
NI32 Exitcode;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY10602 {
NI Refcount;
TNimType* Typ;
};
typedef N_STDCALL_PTR(void, TY8016) (TY8004* L_8018);
struct TY10618 {
NI Len;
NI Cap;
TY10602** D;
};
struct TY10614 {
NI Counter;
NI Max;
TY10610* Head;
TY10610** Data;
};
struct TY8004 {
void* Debuginfo;
NI32 Lockcount;
NI32 Recursioncount;
NI Owningthread;
NI Locksemaphore;
NI32 Reserved;
};
struct TY10988 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY10990 {
TY10618 Zct;
TY10618 Decstack;
TY10614 Cycleroots;
TY10618 Tempstack;
TY8004 Cyclerootslock;
TY8004 Zctlock;
TY10988 Stat;
};
typedef N_STDCALL_PTR(void, TY8020) (TY8004* L_8022);
typedef N_NIMCALL_PTR(void, TY61028) (TY61027* S_61029);
typedef N_NIMCALL_PTR(NIM_BOOL, TY61032) (TY61027* S_61033);
typedef N_NIMCALL_PTR(void, TY61036) (TY61027* S_61037, NI Pos_61038);
typedef N_NIMCALL_PTR(NI, TY61041) (TY61027* S_61042);
typedef N_NIMCALL_PTR(NI, TY61045) (TY61027* S_61046, void* Buffer_61047, NI Buflen_61048);
typedef N_NIMCALL_PTR(void, TY61051) (TY61027* S_61052, void* Buffer_61053, NI Buflen_61054);
struct TY61027 {
  TNimObject Sup;
TY61028 Close;
TY61032 Atend;
TY61036 Setposition;
TY61041 Getposition;
TY61045 Readdata;
TY61051 Writedata;
};
struct TY63204 {
  TY61027 Sup;
NI Handle;
NIM_BOOL Attheend;
};
typedef N_STDCALL_PTR(NI32, TY27482) (NI Hfile_27483, void* Buffer_27484, NI32 Nnumberofbytestoread_27485, NI32* Lpnumberofbytesread_27487, void* Lpoverlapped_27488);
typedef N_STDCALL_PTR(NI32, TY27490) (NI Hfile_27491, void* Buffer_27492, NI32 Nnumberofbytestowrite_27493, NI32* Lpnumberofbyteswritten_27495, void* Lpoverlapped_27496);
struct TY40004 {
NimStringDesc* Key;
NimStringDesc* Val;
};
struct TY60408 {
  TNimObject Sup;
NI Counter;
TY40006* Data;
NU8 Mode;
};
struct TY27432 {
NI32 Nlength;
void* Lpsecuritydescriptor;
NI32 Binherithandle;
};
typedef N_STDCALL_PTR(NI32, TY27498) (NI* Hreadpipe_27500, NI* Hwritepipe_27501, TY27432* Lppipeattributes_27503, NI32 Nsize_27504);
typedef N_STDCALL_PTR(NI32, TY27476) (NI Hobject_27477);
struct TY27434 {
NI32 Cb;
NCSTRING Lpreserved;
NCSTRING Lpdesktop;
NCSTRING Lptitle;
NI32 Dwx;
NI32 Dwy;
NI32 Dwxsize;
NI32 Dwysize;
NI32 Dwxcountchars;
NI32 Dwycountchars;
NI32 Dwfillattribute;
NI32 Dwflags;
NI16 Wshowwindow;
NI16 Cbreserved2;
void* Lpreserved2;
NI Hstdinput;
NI Hstdoutput;
NI Hstderror;
};
struct TY27436 {
NI Hprocess;
NI Hthread;
NI32 Dwprocessid;
NI32 Dwthreadid;
};
typedef N_STDCALL_PTR(NI, TY27541) (NI32 Nstdhandle_27542);
typedef NimStringDesc* TY63426[2];
typedef N_STDCALL_PTR(NI32, TY27506) (NCSTRING Lpapplicationname_27507, NCSTRING Lpcommandline_27508, TY27432* Lpprocessattributes_27510, TY27432* Lpthreadattributes_27512, NI32 Binherithandles_27513, NI32 Dwcreationflags_27514, void* Lpenvironment_27515, NCSTRING Lpcurrentdirectory_27516, TY27434* Lpstartupinfo_27518, TY27436* Lpprocessinformation_27520);
typedef N_STDCALL_PTR(NI32, TY27522) (NI Hthread_27523);
typedef N_STDCALL_PTR(NI32, TY27525) (NI Hthread_27526);
typedef N_STDCALL_PTR(NI32, TY27528) (NI Hhandle_27529, NI32 Dwmilliseconds_27530);
typedef N_STDCALL_PTR(NI32, TY27532) (NI Hprocess_27533, NI Uexitcode_27534);
typedef N_STDCALL_PTR(NI32, TY27536) (NI Hprocess_27537, NI32* Lpexitcode_27539);
typedef NI TY8614[8];
struct TY10610 {
TY10610* Next;
NI Key;
TY8614 Bits;
};
struct TY4377 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
struct TY62701 {
  TGenericSeq Sup;
  TY62202* data[SEQ_DECL_SIZE];
};
struct TY40006 {
  TGenericSeq Sup;
  TY40004 data[SEQ_DECL_SIZE];
};
N_NIMCALL(NimStringDesc*, Executeprocess_62223)(NimStringDesc* Command_62225, NU8 Options_62228);
N_NIMCALL(NI, Executecommand_62233)(NimStringDesc* Command_62235);
N_NIMCALL(NI, nospprocessID)(TY62202* P_62264);
N_NIMCALL(NI, nospcountProcessors)(void);
N_NIMCALL(NimStringDesc*, Getenv_34425)(NimStringDesc* Key_34427);
N_NIMCALL(NI, nsuParseInt)(NimStringDesc* S_24504);
N_NIMCALL(TY62202*, Startprocessaux_62606)(NimStringDesc* Cmd_62608, NU8 Options_62610);
N_NIMCALL(TY4377*, nosparseCmdLine)(NimStringDesc* C_35434);
N_NIMCALL(void*, newSeq)(TNimType* Typ_12804, NI Len_12805);
static N_INLINE(NI, subInt)(NI A_6003, NI B_6004);
N_NOINLINE(void, raiseOverflow)(void);
N_NOINLINE(void, raiseIndexError)(void);
N_NIMCALL(TGenericSeq*, incrSeq)(TGenericSeq* Seq_17435, NI Elemsize_17436);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11818, void* Src_11819);
static N_INLINE(TY10602*, Usrtocell_11036)(void* Usr_11038);
static N_INLINE(NI, Atomicinc_3001)(NI* Memloc_3004, NI X_3005);
static N_INLINE(NI, Atomicdec_3006)(NI* Memloc_3009, NI X_3010);
static N_INLINE(void, Rtladdzct_11658)(TY10602* C_11660);
N_NOINLINE(void, Addzct_11025)(TY10618* S_11028, TY10602* C_11029);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_17308);
static N_INLINE(NI, addInt)(NI A_5803, NI B_5804);
N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** Cmds_62692, NI Cmds_62692Len0, NU8 Options_62694, NI N_62695);
N_NIMCALL(void, internalAssert)(NCSTRING File_5254, NI Line_5255, NIM_BOOL Cond_5256);
N_NIMCALL(void, nossleep)(NI Milsecs_37206);
N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* Command_62219, NU8 Options_62222);
N_NIMCALL(NimStringDesc*, Readline_61210)(TY61027* S_61212);
static N_INLINE(void, appendString)(NimStringDesc* Dest_17392, NimStringDesc* Src_17393);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* Dest_17382, NI Addlen_17383);
N_NIMCALL(void, Hsclose_63207)(TY63204* S_63209);
N_NIMCALL(NIM_BOOL, Hsatend_63210)(TY63204* S_63212);
N_NIMCALL(NI, Hsreaddata_63214)(TY63204* S_63216, void* Buffer_63217, NI Buflen_63218);
static N_INLINE(NI, chckRange)(NI I_4610, NI A_4611, NI B_4612);
N_NOINLINE(void, raiseRangeError)(NI64 Val_5418);
N_NOINLINE(void, nosOSError)(NimStringDesc* Msg_31004);
N_NIMCALL(void, Hswritedata_63229)(TY63204* S_63231, void* Buffer_63232, NI Buflen_63233);
N_NIMCALL(TY63204*, Newfilehandlestream_63239)(NI Handle_63241);
N_NIMCALL(void*, newObj)(TNimType* Typ_12307, NI Size_12308);
N_NIMCALL(NCSTRING, Buildcommandline_63258)(NimStringDesc* A_63260, NimStringDesc** Args_63262, NI Args_63262Len0);
N_NIMCALL(NimStringDesc*, Quoteifcontainswhite_25283)(NimStringDesc* S_25285);
N_NIMCALL(NimStringDesc*, addChar)(NimStringDesc* S_1603, NIM_CHAR C_1604);
N_NOCONV(void*, Alloc0_1953)(NI Size_1955);
N_NIMCALL(NCSTRING, Buildenv_63277)(TY60408* Env_63279);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_17287);
N_NIMCALL(void, Createpipehandles_63336)(NI* Rdhandle_63339, NI* Wrhandle_63340);
static N_INLINE(void, Fileclose_63345)(NI H_63347);
N_NIMCALL(TY62202*, nospstartProcess)(NimStringDesc* Command_62239, NimStringDesc* Workingdir_62240, NimStringDesc** Args_62245, NI Args_62245Len0, TY60408* Env_62246, NU8 Options_62249);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING Str_17304);
static N_INLINE(void, rawEcho)(NimStringDesc* X_4094);
N_NIMCALL(void, Write_3658)(FILE* F_3660, NimStringDesc* S_3661);
static N_INLINE(void, rawEchoNL)(void);
N_NOCONV(void, Dealloc_1960)(void* P_1962);
N_NIMCALL(void, nospsuspend)(TY62202* P_62252);
N_NIMCALL(void, nospresume)(TY62202* P_62255);
N_NIMCALL(NIM_BOOL, nosprunning)(TY62202* P_62261);
N_NIMCALL(void, nospterminate)(TY62202* P_62258);
N_NIMCALL(NI, nospwaitForExit)(TY62202* P_62268);
N_NIMCALL(TY61027*, nospinputStream)(TY62202* P_62271);
N_NIMCALL(TY61027*, nospoutputStream)(TY62202* P_62274);
N_NIMCALL(TY61027*, nosperrorStream)(TY62202* P_62277);
N_NIMCALL(NI, nospexecCmd)(NimStringDesc* Command_62232);
N_NIMCALL(TY4377*, HEX26_63435)(NimStringDesc** X_63439, NI X_63439Len0, NimStringDesc** Y_63440, NI Y_63440Len0);
STRING_LITERAL(TMP62603, "NUMBER_OF_PROCESSORS", 20);
STRING_LITERAL(TMP62688, "", 0);
STRING_LITERAL(TMP63002, "\015\012", 2);
STRING_LITERAL(TMP63843, "=", 1);
STRING_LITERAL(TMP63844, "COMSPEC", 7);
STRING_LITERAL(TMP63845, "/c", 2);
extern TNimType* NTI4377; /* seq[string] */
extern TY8016 Dl_8015;
extern TY10990 Gch_11010;
extern TY8020 Dl_8019;
extern TNimType* NTI62701; /* seq[PProcess] */
extern TY27482 Dl_27481;
extern TY27490 Dl_27489;
extern TNimType* NTI63202; /* PFileHandleStream */
extern TNimType* NTI63204; /* TFileHandleStream */
extern TY27498 Dl_27497;
extern TY27476 Dl_27475;
extern TNimType* NTI62204; /* PProcess */
extern TNimType* NTI62202; /* TProcess */
extern TY27541 Dl_27540;
extern TY27506 Dl_27505;
extern TY27522 Dl_27521;
extern TY27525 Dl_27524;
extern TY27528 Dl_27527;
extern TY27532 Dl_27531;
extern TY27536 Dl_27535;
N_NIMCALL(NimStringDesc*, Executeprocess_62223)(NimStringDesc* Command_62225, NU8 Options_62228) {
NimStringDesc* Result_62229;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "executeProcess";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62229 = 0;
F.line = 54;F.filename = "osproc.nim";
Result_62229 = nospexecProcess(Command_62225, Options_62228);
framePtr = framePtr->prev;
return Result_62229;
}
N_NIMCALL(NI, Executecommand_62233)(NimStringDesc* Command_62235) {
NI Result_62236;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "executeCommand";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62236 = 0;
F.line = 62;F.filename = "osproc.nim";
Result_62236 = nospexecCmd(Command_62235);
framePtr = framePtr->prev;
return Result_62236;
}
N_NIMCALL(NI, nospprocessID)(TY62202* P_62264) {
NI Result_62265;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "processID";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62265 = 0;
F.line = 99;F.filename = "osproc.nim";
F.line = 99;F.filename = "osproc.nim";
Result_62265 = ((NI) ((*P_62264).Id));
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_62265;
}
N_NIMCALL(NI, nospcountProcessors)(void) {
NI Result_62403;
NimStringDesc* X_62404;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "countProcessors";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62403 = 0;
X_62404 = 0;
F.line = 126;F.filename = "osproc.nim";
X_62404 = Getenv_34425(((NimStringDesc*) &TMP62603));
F.line = 127;F.filename = "osproc.nim";
if (!(0 < X_62404->Sup.len)) goto LA2;
F.line = 127;F.filename = "osproc.nim";
Result_62403 = nsuParseInt(X_62404);
LA2: ;
F.line = 147;F.filename = "osproc.nim";
if (!(Result_62403 <= 0)) goto LA5;
F.line = 147;F.filename = "osproc.nim";
Result_62403 = 1;
LA5: ;
framePtr = framePtr->prev;
return Result_62403;
}
static N_INLINE(NI, subInt)(NI A_6003, NI B_6004) {
NI Result_6005;
NIM_BOOL LOC2;
Result_6005 = 0;
Result_6005 = (NI64)((NU64)(A_6003) - (NU64)(B_6004));
LOC2 = (0 <= (NI64)(Result_6005 ^ A_6003));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_6005 ^ (NI64)((NU64) ~(B_6004))));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_6005;
}
static N_INLINE(TY10602*, Usrtocell_11036)(void* Usr_11038) {
TY10602* Result_11039;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "usrToCell";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_11039 = 0;
F.line = 100;F.filename = "gc.nim";
Result_11039 = ((TY10602*) ((NI64)((NU64)(((NI) (Usr_11038))) - (NU64)(((NI) (((NI)sizeof(TY10602))))))));
framePtr = framePtr->prev;
return Result_11039;
}
static N_INLINE(NI, Atomicinc_3001)(NI* Memloc_3004, NI X_3005) {
NI Result_7408;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicInc";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7408 = 0;
F.line = 29;F.filename = "systhread.nim";
Result_7408 = __sync_add_and_fetch(Memloc_3004, X_3005);
framePtr = framePtr->prev;
return Result_7408;
}
static N_INLINE(NI, Atomicdec_3006)(NI* Memloc_3009, NI X_3010) {
NI Result_7606;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicDec";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7606 = 0;
F.line = 37;F.filename = "systhread.nim";
Result_7606 = __sync_sub_and_fetch(Memloc_3009, X_3010);
framePtr = framePtr->prev;
return Result_7606;
}
static N_INLINE(void, Rtladdzct_11658)(TY10602* C_11660) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "rtlAddZCT";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 211;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA2;
F.line = 211;F.filename = "gc.nim";
Dl_8015(&Gch_11010.Zctlock);
LA2: ;
F.line = 212;F.filename = "gc.nim";
Addzct_11025(&Gch_11010.Zct, C_11660);
F.line = 213;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA5;
F.line = 213;F.filename = "gc.nim";
Dl_8019(&Gch_11010.Zctlock);
LA5: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11818, void* Src_11819) {
TY10602* C_11820;
NI LOC4;
TY10602* C_11822;
NI LOC9;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "asgnRefNoCycle";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 244;F.filename = "gc.nim";
if (!!((Src_11819 == NIM_NIL))) goto LA2;
C_11820 = 0;
F.line = 245;F.filename = "gc.nim";
C_11820 = Usrtocell_11036(Src_11819);
F.line = 246;F.filename = "gc.nim";
LOC4 = Atomicinc_3001(&(*C_11820).Refcount, 8);
LA2: ;
F.line = 247;F.filename = "gc.nim";
if (!!(((*Dest_11818) == NIM_NIL))) goto LA6;
C_11822 = 0;
F.line = 248;F.filename = "gc.nim";
C_11822 = Usrtocell_11036((*Dest_11818));
F.line = 249;F.filename = "gc.nim";
LOC9 = Atomicdec_3006(&(*C_11822).Refcount, 8);
if (!((NU64)(LOC9) < (NU64)(8))) goto LA10;
F.line = 250;F.filename = "gc.nim";
Rtladdzct_11658(C_11822);
LA10: ;
LA6: ;
F.line = 251;F.filename = "gc.nim";
(*Dest_11818) = Src_11819;
framePtr = framePtr->prev;
}
static N_INLINE(NI, addInt)(NI A_5803, NI B_5804) {
NI Result_5805;
NIM_BOOL LOC2;
Result_5805 = 0;
Result_5805 = (NI64)((NU64)(A_5803) + (NU64)(B_5804));
LOC2 = (0 <= (NI64)(Result_5805 ^ A_5803));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5805 ^ B_5804));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5805;
}
N_NIMCALL(TY62202*, Startprocessaux_62606)(NimStringDesc* Cmd_62608, NU8 Options_62610) {
TY62202* Result_62611;
TY4377* C_62612;
TY4377* A_62630;
NI I_62663;
NI HEX3Atmp_62683;
NI Res_62685;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "startProcessAux";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62611 = 0;
C_62612 = 0;
F.line = 150;F.filename = "osproc.nim";
C_62612 = nosparseCmdLine(Cmd_62608);
A_62630 = 0;
F.line = 151;F.filename = "osproc.nim";
A_62630 = (TY4377*) newSeq(NTI4377, 0);
I_62663 = 0;
HEX3Atmp_62683 = 0;
F.line = 152;F.filename = "osproc.nim";
HEX3Atmp_62683 = subInt(C_62612->Sup.len, 1);
Res_62685 = 0;
F.line = 1021;F.filename = "system.nim";
Res_62685 = 1;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_62685 <= HEX3Atmp_62683)) goto LA1;
F.line = 1021;F.filename = "system.nim";
I_62663 = Res_62685;
F.line = 152;F.filename = "osproc.nim";
if ((NU)(I_62663) >= (NU)(C_62612->Sup.len)) raiseIndexError();
A_62630 = (TY4377*) incrSeq(&(A_62630)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &A_62630->data[A_62630->Sup.len-1], copyString(C_62612->data[I_62663]));
F.line = 1024;F.filename = "system.nim";
Res_62685 = addInt(Res_62685, 1);
} LA1: ;
F.line = 153;F.filename = "osproc.nim";
if ((NU)(0) >= (NU)(C_62612->Sup.len)) raiseIndexError();
Result_62611 = nospstartProcess(C_62612->data[0], ((NimStringDesc*) &TMP62688), A_62630->data, A_62630->Sup.len, NIM_NIL, Options_62610);
framePtr = framePtr->prev;
return Result_62611;
}
N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** Cmds_62692, NI Cmds_62692Len0, NU8 Options_62694, NI N_62695) {
NI Result_62696;
TY62701* Q_62702;
NI M_62727;
NI I_62735;
NI HEX3Atmp_62823;
NI Res_62825;
NI I_62736;
NI R_62746;
NI HEX3Atmp_62829;
NI Res_62831;
NIM_BOOL LOC8;
NI LOC11;
NI I_62808;
NI HEX3Atmp_62836;
NI Res_62838;
NI LOC16;
NI I_62818;
NI HEX3Atmp_62842;
NI Res_62844;
TY62202* P_62819;
NI LOC18;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "execProcesses";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62696 = 0;
F.line = 161;F.filename = "osproc.nim";
internalAssert("/home/andreas/projects/nimrod/lib/pure/osproc.nim", 161, (0 < N_62695));
F.line = 162;F.filename = "osproc.nim";
if (!(1 < N_62695)) goto LA2;
Q_62702 = 0;
F.line = 164;F.filename = "osproc.nim";
Q_62702 = (TY62701*) newSeq(NTI62701, N_62695);
M_62727 = 0;
F.line = 165;F.filename = "osproc.nim";
M_62727 = ((N_62695 <= Cmds_62692Len0) ? N_62695 : Cmds_62692Len0);
I_62735 = 0;
HEX3Atmp_62823 = 0;
F.line = 166;F.filename = "osproc.nim";
HEX3Atmp_62823 = subInt(M_62727, 1);
Res_62825 = 0;
F.line = 1021;F.filename = "system.nim";
Res_62825 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_62825 <= HEX3Atmp_62823)) goto LA4;
F.line = 1021;F.filename = "system.nim";
I_62735 = Res_62825;
F.line = 167;F.filename = "osproc.nim";
if ((NU)(I_62735) >= (NU)(Q_62702->Sup.len)) raiseIndexError();
if ((NU)(I_62735) >= (NU)(Cmds_62692Len0)) raiseIndexError();
asgnRefNoCycle((void**) &Q_62702->data[I_62735], Startprocessaux_62606(Cmds_62692[I_62735], Options_62694));
F.line = 1024;F.filename = "system.nim";
Res_62825 = addInt(Res_62825, 1);
} LA4: ;
I_62736 = 0;
F.line = 182;F.filename = "osproc.nim";
I_62736 = M_62727;
F.line = 183;F.filename = "osproc.nim";
while (1) {
if (!(I_62736 <= (Cmds_62692Len0-1))) goto LA5;
F.line = 184;F.filename = "osproc.nim";
nossleep(50);
R_62746 = 0;
HEX3Atmp_62829 = 0;
F.line = 185;F.filename = "osproc.nim";
HEX3Atmp_62829 = subInt(N_62695, 1);
Res_62831 = 0;
F.line = 1021;F.filename = "system.nim";
Res_62831 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_62831 <= HEX3Atmp_62829)) goto LA6;
F.line = 1021;F.filename = "system.nim";
R_62746 = Res_62831;
F.line = 186;F.filename = "osproc.nim";
if ((NU)(R_62746) >= (NU)(Q_62702->Sup.len)) raiseIndexError();
LOC8 = nosprunning(Q_62702->data[R_62746]);
if (!!(LOC8)) goto LA9;
F.line = 188;F.filename = "osproc.nim";
if ((NU)(R_62746) >= (NU)(Q_62702->Sup.len)) raiseIndexError();
LOC11 = nospwaitForExit(Q_62702->data[R_62746]);
Result_62696 = ((LOC11 >= Result_62696) ? LOC11 : Result_62696);
F.line = 189;F.filename = "osproc.nim";
if ((NU)(R_62746) >= (NU)(Q_62702->Sup.len)) raiseIndexError();
if ((NU)(I_62736) >= (NU)(Cmds_62692Len0)) raiseIndexError();
asgnRefNoCycle((void**) &Q_62702->data[R_62746], Startprocessaux_62606(Cmds_62692[I_62736], Options_62694));
F.line = 190;F.filename = "osproc.nim";
I_62736 = addInt(I_62736, 1);
F.line = 191;F.filename = "osproc.nim";
if (!((Cmds_62692Len0-1) < I_62736)) goto LA13;
F.line = 191;F.filename = "osproc.nim";
goto LA6;
LA13: ;
LA9: ;
F.line = 1024;F.filename = "system.nim";
Res_62831 = addInt(Res_62831, 1);
} LA6: ;
} LA5: ;
I_62808 = 0;
HEX3Atmp_62836 = 0;
F.line = 192;F.filename = "osproc.nim";
HEX3Atmp_62836 = subInt(M_62727, 1);
Res_62838 = 0;
F.line = 1021;F.filename = "system.nim";
Res_62838 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_62838 <= HEX3Atmp_62836)) goto LA15;
F.line = 1021;F.filename = "system.nim";
I_62808 = Res_62838;
F.line = 193;F.filename = "osproc.nim";
if ((NU)(I_62808) >= (NU)(Q_62702->Sup.len)) raiseIndexError();
LOC16 = nospwaitForExit(Q_62702->data[I_62808]);
Result_62696 = ((LOC16 >= Result_62696) ? LOC16 : Result_62696);
F.line = 1024;F.filename = "system.nim";
Res_62838 = addInt(Res_62838, 1);
} LA15: ;
goto LA1;
LA2: ;
I_62818 = 0;
HEX3Atmp_62842 = 0;
F.line = 195;F.filename = "osproc.nim";
HEX3Atmp_62842 = (Cmds_62692Len0-1);
Res_62844 = 0;
F.line = 1021;F.filename = "system.nim";
Res_62844 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_62844 <= HEX3Atmp_62842)) goto LA17;
F.line = 1021;F.filename = "system.nim";
I_62818 = Res_62844;
P_62819 = 0;
F.line = 196;F.filename = "osproc.nim";
if ((NU)(I_62818) >= (NU)(Cmds_62692Len0)) raiseIndexError();
P_62819 = Startprocessaux_62606(Cmds_62692[I_62818], Options_62694);
F.line = 197;F.filename = "osproc.nim";
LOC18 = nospwaitForExit(P_62819);
Result_62696 = ((LOC18 >= Result_62696) ? LOC18 : Result_62696);
F.line = 1024;F.filename = "system.nim";
Res_62844 = addInt(Res_62844, 1);
} LA17: ;
LA1: ;
framePtr = framePtr->prev;
return Result_62696;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_17392, NimStringDesc* Src_17393) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendString";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 150;F.filename = "sysstr.nim";
memcpy(((NCSTRING) (&(*Dest_17392).data[((*Dest_17392).Sup.len)-0])), ((NCSTRING) ((*Src_17393).data)), ((NI32) ((NI64)((NI64)((*Src_17393).Sup.len + 1) * 1))));
F.line = 151;F.filename = "sysstr.nim";
(*Dest_17392).Sup.len += (*Src_17393).Sup.len;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* Command_62219, NU8 Options_62222) {
NimStringDesc* Result_62854;
TY62202* P_62855;
TY61027* Outp_62856;
NIM_BOOL LOC2;
NIM_BOOL LOC4;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "execProcess";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62854 = 0;
P_62855 = 0;
F.line = 203;F.filename = "osproc.nim";
P_62855 = Startprocessaux_62606(Command_62219, Options_62222);
Outp_62856 = 0;
F.line = 204;F.filename = "osproc.nim";
Outp_62856 = nospoutputStream(P_62855);
F.line = 205;F.filename = "osproc.nim";
Result_62854 = copyString(((NimStringDesc*) &TMP62688));
F.line = 206;F.filename = "osproc.nim";
while (1) {
LOC2 = nosprunning(P_62855);
if (LOC2) goto LA3;
LOC4 = (*Outp_62856).Atend(Outp_62856);
LOC2 = !(LOC4);
LA3: ;
if (!LOC2) goto LA1;
F.line = 207;F.filename = "osproc.nim";
LOC5 = 0;
LOC5 = Readline_61210(Outp_62856);
Result_62854 = resizeString(Result_62854, LOC5->Sup.len + 0);
appendString(Result_62854, LOC5);
F.line = 208;F.filename = "osproc.nim";
Result_62854 = resizeString(Result_62854, 2);
appendString(Result_62854, ((NimStringDesc*) &TMP63002));
} LA1: ;
framePtr = framePtr->prev;
return Result_62854;
}
N_NIMCALL(void, Hsclose_63207)(TY63204* S_63209) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "hsClose";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
framePtr = framePtr->prev;
}
N_NIMCALL(NIM_BOOL, Hsatend_63210)(TY63204* S_63212) {
NIM_BOOL Result_63213;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "hsAtEnd";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63213 = 0;
F.line = 227;F.filename = "osproc.nim";
F.line = 227;F.filename = "osproc.nim";
Result_63213 = (*S_63212).Attheend;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_63213;
}
static N_INLINE(NI, chckRange)(NI I_4610, NI A_4611, NI B_4612) {
NI Result_5516;
NIM_BOOL LOC2;
Result_5516 = 0;
LOC2 = (A_4611 <= I_4610);
if (!(LOC2)) goto LA3;
LOC2 = (I_4610 <= B_4612);
LA3: ;
if (!LOC2) goto LA4;
Result_5516 = I_4610;
goto BeforeRet;
goto LA1;
LA4: ;
raiseRangeError(((NI64) (I_4610)));
LA1: ;
BeforeRet: ;
return Result_5516;
}
N_NIMCALL(NI, Hsreaddata_63214)(TY63204* S_63216, void* Buffer_63217, NI Buflen_63218) {
NI Result_63219;
NI32 Br_63220;
NI32 A_63222;
NIM_BOOL LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "hsReadData";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63219 = 0;
F.line = 230;F.filename = "osproc.nim";
if (!(*S_63216).Attheend) goto LA2;
F.line = 230;F.filename = "osproc.nim";
F.line = 230;F.filename = "osproc.nim";
Result_63219 = 0;
goto BeforeRet;
LA2: ;
Br_63220 = 0;
A_63222 = 0;
F.line = 232;F.filename = "osproc.nim";
A_63222 = Dl_27481((*S_63216).Handle, Buffer_63217, ((NI32)chckRange(Buflen_63218, ((NI32) (-2147483647 -1)), ((NI32) 2147483647))), &Br_63220, NIM_NIL);
F.line = 236;F.filename = "osproc.nim";
LOC5 = (((NI) (A_63222)) == 0);
if (!(LOC5)) goto LA6;
LOC5 = !((((NI) (Br_63220)) == 0));
LA6: ;
if (!LOC5) goto LA7;
F.line = 236;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP62688));
LA7: ;
F.line = 237;F.filename = "osproc.nim";
(*S_63216).Attheend = (((NI) (Br_63220)) < Buflen_63218);
F.line = 238;F.filename = "osproc.nim";
Result_63219 = ((NI) (Br_63220));
BeforeRet: ;
framePtr = framePtr->prev;
return Result_63219;
}
N_NIMCALL(void, Hswritedata_63229)(TY63204* S_63231, void* Buffer_63232, NI Buflen_63233) {
NI32 Byteswritten_63234;
NI32 A_63236;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "hsWriteData";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Byteswritten_63234 = 0;
A_63236 = 0;
F.line = 242;F.filename = "osproc.nim";
A_63236 = Dl_27489((*S_63231).Handle, Buffer_63232, ((NI32)chckRange(Buflen_63233, ((NI32) (-2147483647 -1)), ((NI32) 2147483647))), &Byteswritten_63234, NIM_NIL);
F.line = 243;F.filename = "osproc.nim";
if (!(((NI) (A_63236)) == 0)) goto LA2;
F.line = 243;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP62688));
LA2: ;
framePtr = framePtr->prev;
}
N_NIMCALL(TY63204*, Newfilehandlestream_63239)(NI Handle_63241) {
TY63204* Result_63242;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "newFileHandleStream";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63242 = 0;
F.line = 246;F.filename = "osproc.nim";
Result_63242 = (TY63204*) newObj(NTI63202, sizeof(TY63204));
(*Result_63242).Sup.Sup.m_type = NTI63204;
F.line = 247;F.filename = "osproc.nim";
(*Result_63242).Handle = Handle_63241;
F.line = 248;F.filename = "osproc.nim";
(*Result_63242).Sup.Close = ((TY61028) (Hsclose_63207));
F.line = 249;F.filename = "osproc.nim";
(*Result_63242).Sup.Atend = ((TY61032) (Hsatend_63210));
F.line = 250;F.filename = "osproc.nim";
(*Result_63242).Sup.Readdata = ((TY61045) (Hsreaddata_63214));
F.line = 251;F.filename = "osproc.nim";
(*Result_63242).Sup.Writedata = ((TY61051) (Hswritedata_63229));
framePtr = framePtr->prev;
return Result_63242;
}
N_NIMCALL(NCSTRING, Buildcommandline_63258)(NimStringDesc* A_63260, NimStringDesc** Args_63262, NI Args_63262Len0) {
NCSTRING Result_63263;
NimStringDesc* Res_63264;
NI I_63272;
NI HEX3Atmp_63814;
NI Res_63816;
NimStringDesc* LOC2;
void* LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "buildCommandLine";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63263 = 0;
Res_63264 = 0;
F.line = 254;F.filename = "osproc.nim";
Res_63264 = Quoteifcontainswhite_25283(A_63260);
I_63272 = 0;
HEX3Atmp_63814 = 0;
F.line = 255;F.filename = "osproc.nim";
HEX3Atmp_63814 = (Args_63262Len0-1);
Res_63816 = 0;
F.line = 1021;F.filename = "system.nim";
Res_63816 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_63816 <= HEX3Atmp_63814)) goto LA1;
F.line = 1021;F.filename = "system.nim";
I_63272 = Res_63816;
F.line = 256;F.filename = "osproc.nim";
Res_63264 = addChar(Res_63264, 32);
F.line = 257;F.filename = "osproc.nim";
if ((NU)(I_63272) >= (NU)(Args_63262Len0)) raiseIndexError();
LOC2 = 0;
LOC2 = Quoteifcontainswhite_25283(Args_63262[I_63272]);
Res_63264 = resizeString(Res_63264, LOC2->Sup.len + 0);
appendString(Res_63264, LOC2);
F.line = 1024;F.filename = "system.nim";
Res_63816 = addInt(Res_63816, 1);
} LA1: ;
F.line = 258;F.filename = "osproc.nim";
LOC3 = Alloc0_1953(addInt(Res_63264->Sup.len, 1));
Result_63263 = ((NCSTRING) (LOC3));
F.line = 259;F.filename = "osproc.nim";
memcpy(((void*) (Result_63263)), ((void*) (Res_63264->data)), Res_63264->Sup.len);
framePtr = framePtr->prev;
return Result_63263;
}
N_NIMCALL(NCSTRING, Buildenv_63277)(TY60408* Env_63279) {
NCSTRING Result_63280;
NI L_63281;
NimStringDesc* Key_63282;
NimStringDesc* Val_63283;
NI H_63821;
NI HEX3Atmp_63823;
NI Res_63825;
void* LOC5;
NimStringDesc* Key_63300;
NimStringDesc* Val_63301;
NI H_63832;
NI HEX3Atmp_63834;
NI Res_63836;
NimStringDesc* X_63318;
NimStringDesc* LOC10;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "buildEnv";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63280 = 0;
L_63281 = 0;
F.line = 262;F.filename = "osproc.nim";
L_63281 = 0;
Key_63282 = 0;
Val_63283 = 0;
H_63821 = 0;
HEX3Atmp_63823 = 0;
F.line = 40;F.filename = "strtabs.nim";
HEX3Atmp_63823 = ((*Env_63279).Data->Sup.len-1);
Res_63825 = 0;
F.line = 1021;F.filename = "system.nim";
Res_63825 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_63825 <= HEX3Atmp_63823)) goto LA1;
F.line = 1021;F.filename = "system.nim";
H_63821 = Res_63825;
F.line = 41;F.filename = "strtabs.nim";
if ((NU)(H_63821) >= (NU)((*Env_63279).Data->Sup.len)) raiseIndexError();
if (!!((*Env_63279).Data->data[H_63821].Key == 0)) goto LA3;
F.line = 42;F.filename = "strtabs.nim";
if ((NU)(H_63821) >= (NU)((*Env_63279).Data->Sup.len)) raiseIndexError();
Key_63282 = (*Env_63279).Data->data[H_63821].Key;
F.line = 42;F.filename = "strtabs.nim";
if ((NU)(H_63821) >= (NU)((*Env_63279).Data->Sup.len)) raiseIndexError();
Val_63283 = (*Env_63279).Data->data[H_63821].Val;
F.line = 263;F.filename = "osproc.nim";
L_63281 = addInt(L_63281, addInt(addInt(Key_63282->Sup.len, Val_63283->Sup.len), 2));
LA3: ;
F.line = 1024;F.filename = "system.nim";
Res_63825 = addInt(Res_63825, 1);
} LA1: ;
F.line = 264;F.filename = "osproc.nim";
LOC5 = Alloc0_1953(addInt(L_63281, 2));
Result_63280 = ((NCSTRING) (LOC5));
F.line = 265;F.filename = "osproc.nim";
L_63281 = 0;
Key_63300 = 0;
Val_63301 = 0;
H_63832 = 0;
HEX3Atmp_63834 = 0;
F.line = 40;F.filename = "strtabs.nim";
HEX3Atmp_63834 = ((*Env_63279).Data->Sup.len-1);
Res_63836 = 0;
F.line = 1021;F.filename = "system.nim";
Res_63836 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_63836 <= HEX3Atmp_63834)) goto LA6;
F.line = 1021;F.filename = "system.nim";
H_63832 = Res_63836;
F.line = 41;F.filename = "strtabs.nim";
if ((NU)(H_63832) >= (NU)((*Env_63279).Data->Sup.len)) raiseIndexError();
if (!!((*Env_63279).Data->data[H_63832].Key == 0)) goto LA8;
F.line = 42;F.filename = "strtabs.nim";
if ((NU)(H_63832) >= (NU)((*Env_63279).Data->Sup.len)) raiseIndexError();
Key_63300 = (*Env_63279).Data->data[H_63832].Key;
F.line = 42;F.filename = "strtabs.nim";
if ((NU)(H_63832) >= (NU)((*Env_63279).Data->Sup.len)) raiseIndexError();
Val_63301 = (*Env_63279).Data->data[H_63832].Val;
X_63318 = 0;
F.line = 267;F.filename = "osproc.nim";
LOC10 = 0;
LOC10 = rawNewString(Key_63300->Sup.len + Val_63301->Sup.len + 1);
appendString(LOC10, Key_63300);
appendString(LOC10, ((NimStringDesc*) &TMP63843));
appendString(LOC10, Val_63301);
X_63318 = LOC10;
F.line = 268;F.filename = "osproc.nim";
memcpy(((void*) (&Result_63280[L_63281])), ((void*) (X_63318->data)), addInt(X_63318->Sup.len, 1));
F.line = 269;F.filename = "osproc.nim";
L_63281 = addInt(L_63281, addInt(X_63318->Sup.len, 1));
LA8: ;
F.line = 1024;F.filename = "system.nim";
Res_63836 = addInt(Res_63836, 1);
} LA6: ;
framePtr = framePtr->prev;
return Result_63280;
}
N_NIMCALL(void, Createpipehandles_63336)(NI* Rdhandle_63339, NI* Wrhandle_63340) {
TY27432 Piinheritablepipe_63341;
NI32 LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "CreatePipeHandles";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
memset((void*)&Piinheritablepipe_63341, 0, sizeof(Piinheritablepipe_63341));
F.line = 280;F.filename = "osproc.nim";
Piinheritablepipe_63341.Nlength = ((NI32)chckRange(((NI)sizeof(TY27432)), ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 281;F.filename = "osproc.nim";
Piinheritablepipe_63341.Lpsecuritydescriptor = NIM_NIL;
F.line = 282;F.filename = "osproc.nim";
Piinheritablepipe_63341.Binherithandle = ((NI32) 1);
F.line = 283;F.filename = "osproc.nim";
LOC2 = Dl_27497(Rdhandle_63339, Wrhandle_63340, &Piinheritablepipe_63341, ((NI32) 1024));
if (!(LOC2 == ((NI32) 0))) goto LA3;
F.line = 284;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP62688));
LA3: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, Fileclose_63345)(NI H_63347) {
NI32 LOC4;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "fileClose";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 287;F.filename = "osproc.nim";
if (!(4 < H_63347)) goto LA2;
F.line = 287;F.filename = "osproc.nim";
LOC4 = Dl_27475(H_63347);
LA2: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, rawEcho)(NimStringDesc* X_4094) {
Write_3658(stdout, X_4094);
}
static N_INLINE(void, rawEchoNL)(void) {
Write_3658(stdout, ((NimStringDesc*) &TMP63002));
}
N_NIMCALL(TY62202*, nospstartProcess)(NimStringDesc* Command_62239, NimStringDesc* Workingdir_62240, NimStringDesc** Args_62245, NI Args_62245Len0, TY60408* Env_62246, NU8 Options_62249) {
TY62202* Result_63363;
TY27434 Si_63364;
TY27436 Procinfo_63365;
NI Success_63366;
NI Hi_63367;
NI Ho_63368;
NI He_63369;
NCSTRING Cmdl_63413;
NimStringDesc* LOC10;
TY4377* LOC11;
TY63426 LOC12;
TY4377* LOC13;
NCSTRING Wd_63521;
NCSTRING E_63522;
NimStringDesc* LOC23;
NI32 LOC24;
NI32 LOC37;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "startProcess";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63363 = 0;
memset((void*)&Si_63364, 0, sizeof(Si_63364));
memset((void*)&Procinfo_63365, 0, sizeof(Procinfo_63365));
Success_63366 = 0;
Hi_63367 = 0;
Ho_63368 = 0;
He_63369 = 0;
F.line = 299;F.filename = "osproc.nim";
Result_63363 = (TY62202*) newObj(NTI62204, sizeof(TY62202));
(*Result_63363).Sup.m_type = NTI62202;
F.line = 300;F.filename = "osproc.nim";
Si_63364.Cb = ((NI32)chckRange(((NI)sizeof(TY27434)), ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 301;F.filename = "osproc.nim";
if (!!(((Options_62249 &(1<<((((NU8) 3))&7)))!=0))) goto LA2;
F.line = 302;F.filename = "osproc.nim";
Si_63364.Dwflags = ((NI32) 256);
F.line = 303;F.filename = "osproc.nim";
Createpipehandles_63336(&Si_63364.Hstdinput, &Hi_63367);
F.line = 304;F.filename = "osproc.nim";
Createpipehandles_63336(&Ho_63368, &Si_63364.Hstdoutput);
F.line = 305;F.filename = "osproc.nim";
if (!((Options_62249 &(1<<((((NU8) 2))&7)))!=0)) goto LA5;
F.line = 306;F.filename = "osproc.nim";
Si_63364.Hstderror = Si_63364.Hstdoutput;
F.line = 307;F.filename = "osproc.nim";
He_63369 = Ho_63368;
goto LA4;
LA5: ;
F.line = 309;F.filename = "osproc.nim";
Createpipehandles_63336(&He_63369, &Si_63364.Hstderror);
LA4: ;
F.line = 310;F.filename = "osproc.nim";
(*Result_63363).Inputhandle = ((NI32)chckRange(Hi_63367, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 311;F.filename = "osproc.nim";
(*Result_63363).Outputhandle = ((NI32)chckRange(Ho_63368, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 312;F.filename = "osproc.nim";
(*Result_63363).Errorhandle = ((NI32)chckRange(He_63369, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
goto LA1;
LA2: ;
F.line = 314;F.filename = "osproc.nim";
Si_63364.Hstderror = Dl_27540(((NI32) -12));
F.line = 315;F.filename = "osproc.nim";
Si_63364.Hstdinput = Dl_27540(((NI32) -10));
F.line = 316;F.filename = "osproc.nim";
Si_63364.Hstdoutput = Dl_27540(((NI32) -11));
F.line = 317;F.filename = "osproc.nim";
(*Result_63363).Inputhandle = ((NI32)chckRange(Si_63364.Hstdinput, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 318;F.filename = "osproc.nim";
(*Result_63363).Outputhandle = ((NI32)chckRange(Si_63364.Hstdoutput, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 319;F.filename = "osproc.nim";
(*Result_63363).Errorhandle = ((NI32)chckRange(Si_63364.Hstderror, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
LA1: ;
Cmdl_63413 = 0;
F.line = 322;F.filename = "osproc.nim";
if (!NIM_FALSE) goto LA8;
F.line = 323;F.filename = "osproc.nim";
LOC10 = 0;
LOC10 = Getenv_34425(((NimStringDesc*) &TMP63844));
LOC11 = 0;
LOC11 = (TY4377*) newSeq(NTI4377, 2);
memset((void*)&LOC12, 0, sizeof(LOC12));
LOC12[0] = copyString(((NimStringDesc*) &TMP63845));
LOC12[1] = copyString(Command_62239);
asgnRefNoCycle((void**) &LOC11->data[0], copyString(LOC12[0]));
asgnRefNoCycle((void**) &LOC11->data[1], copyString(LOC12[1]));
LOC13 = 0;
LOC13 = HEX26_63435(LOC11->data, LOC11->Sup.len, Args_62245, Args_62245Len0);
Cmdl_63413 = Buildcommandline_63258(LOC10, LOC13->data, LOC13->Sup.len);
goto LA7;
LA8: ;
F.line = 325;F.filename = "osproc.nim";
Cmdl_63413 = Buildcommandline_63258(Command_62239, Args_62245, Args_62245Len0);
LA7: ;
Wd_63521 = 0;
F.line = 326;F.filename = "osproc.nim";
Wd_63521 = NIM_NIL;
E_63522 = 0;
F.line = 327;F.filename = "osproc.nim";
E_63522 = NIM_NIL;
F.line = 328;F.filename = "osproc.nim";
if (!(0 < Workingdir_62240->Sup.len)) goto LA15;
F.line = 328;F.filename = "osproc.nim";
Wd_63521 = Workingdir_62240->data;
LA15: ;
F.line = 329;F.filename = "osproc.nim";
if (!!((Env_62246 == NIM_NIL))) goto LA18;
F.line = 329;F.filename = "osproc.nim";
E_63522 = Buildenv_63277(Env_62246);
LA18: ;
F.line = 330;F.filename = "osproc.nim";
if (!((Options_62249 &(1<<((((NU8) 0))&7)))!=0)) goto LA21;
F.line = 330;F.filename = "osproc.nim";
LOC23 = 0;
LOC23 = cstrToNimstr(Cmdl_63413);
rawEcho(LOC23);
rawEchoNL();
LA21: ;
F.line = 331;F.filename = "osproc.nim";
LOC24 = Dl_27505(NIM_NIL, Cmdl_63413, NIM_NIL, NIM_NIL, ((NI32) 1), ((NI32) 32), ((void*) (E_63522)), Wd_63521, &Si_63364, &Procinfo_63365);
Success_63366 = ((NI) (LOC24));
F.line = 334;F.filename = "osproc.nim";
if (!!(((Options_62249 &(1<<((((NU8) 3))&7)))!=0))) goto LA26;
F.line = 335;F.filename = "osproc.nim";
Fileclose_63345(Si_63364.Hstdinput);
F.line = 336;F.filename = "osproc.nim";
Fileclose_63345(Si_63364.Hstdoutput);
F.line = 337;F.filename = "osproc.nim";
if (!!(((Options_62249 &(1<<((((NU8) 2))&7)))!=0))) goto LA29;
F.line = 338;F.filename = "osproc.nim";
Fileclose_63345(Si_63364.Hstderror);
LA29: ;
LA26: ;
F.line = 340;F.filename = "osproc.nim";
if (!!((E_63522 == NIM_NIL))) goto LA32;
F.line = 340;F.filename = "osproc.nim";
Dealloc_1960(((void*) (E_63522)));
LA32: ;
F.line = 341;F.filename = "osproc.nim";
Dealloc_1960(((void*) (Cmdl_63413)));
F.line = 342;F.filename = "osproc.nim";
if (!(Success_63366 == 0)) goto LA35;
F.line = 342;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP62688));
LA35: ;
F.line = 344;F.filename = "osproc.nim";
LOC37 = Dl_27475(Procinfo_63365.Hthread);
F.line = 345;F.filename = "osproc.nim";
(*Result_63363).Fprocesshandle = Procinfo_63365.Hprocess;
F.line = 346;F.filename = "osproc.nim";
(*Result_63363).Id = Procinfo_63365.Dwprocessid;
framePtr = framePtr->prev;
return Result_63363;
}
N_NIMCALL(void, nospsuspend)(TY62202* P_62252) {
NI32 LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "suspend";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 349;F.filename = "osproc.nim";
LOC1 = Dl_27521((*P_62252).Fprocesshandle);
framePtr = framePtr->prev;
}
N_NIMCALL(void, nospresume)(TY62202* P_62255) {
NI32 LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "resume";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 352;F.filename = "osproc.nim";
LOC1 = Dl_27524((*P_62255).Fprocesshandle);
framePtr = framePtr->prev;
}
N_NIMCALL(NIM_BOOL, nosprunning)(TY62202* P_62261) {
NIM_BOOL Result_63584;
NI32 X_63585;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "running";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63584 = 0;
X_63585 = 0;
F.line = 355;F.filename = "osproc.nim";
X_63585 = Dl_27527((*P_62261).Fprocesshandle, ((NI32) 50));
F.line = 356;F.filename = "osproc.nim";
F.line = 356;F.filename = "osproc.nim";
Result_63584 = (X_63585 == ((NI32) 258));
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_63584;
}
N_NIMCALL(void, nospterminate)(TY62202* P_62258) {
NIM_BOOL LOC2;
NI32 LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "terminate";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 359;F.filename = "osproc.nim";
LOC2 = nosprunning(P_62258);
if (!LOC2) goto LA3;
F.line = 360;F.filename = "osproc.nim";
LOC5 = Dl_27531((*P_62258).Fprocesshandle, 0);
LA3: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NI, nospwaitForExit)(TY62202* P_62268) {
NI Result_63594;
NI32 LOC1;
NI32 Res_63595;
NI32 LOC2;
NI32 LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "waitForExit";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63594 = 0;
F.line = 363;F.filename = "osproc.nim";
LOC1 = Dl_27527((*P_62268).Fprocesshandle, ((NI32) -1));
Res_63595 = 0;
F.line = 365;F.filename = "osproc.nim";
LOC2 = Dl_27535((*P_62268).Fprocesshandle, &Res_63595);
F.line = 366;F.filename = "osproc.nim";
Result_63594 = ((NI) (Res_63595));
F.line = 367;F.filename = "osproc.nim";
LOC3 = Dl_27475((*P_62268).Fprocesshandle);
framePtr = framePtr->prev;
return Result_63594;
}
N_NIMCALL(TY61027*, nospinputStream)(TY62202* P_62271) {
TY61027* Result_63600;
TY63204* LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "inputStream";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63600 = 0;
F.line = 370;F.filename = "osproc.nim";
LOC1 = 0;
LOC1 = Newfilehandlestream_63239(((NI) ((*P_62271).Inputhandle)));
Result_63600 = &LOC1->Sup;
framePtr = framePtr->prev;
return Result_63600;
}
N_NIMCALL(TY61027*, nospoutputStream)(TY62202* P_62274) {
TY61027* Result_63604;
TY63204* LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "outputStream";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63604 = 0;
F.line = 373;F.filename = "osproc.nim";
LOC1 = 0;
LOC1 = Newfilehandlestream_63239(((NI) ((*P_62274).Outputhandle)));
Result_63604 = &LOC1->Sup;
framePtr = framePtr->prev;
return Result_63604;
}
N_NIMCALL(TY61027*, nosperrorStream)(TY62202* P_62277) {
TY61027* Result_63608;
TY63204* LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "errorStream";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63608 = 0;
F.line = 376;F.filename = "osproc.nim";
LOC1 = 0;
LOC1 = Newfilehandlestream_63239(((NI) ((*P_62277).Errorhandle)));
Result_63608 = &LOC1->Sup;
framePtr = framePtr->prev;
return Result_63608;
}
N_NIMCALL(NI, nospexecCmd)(NimStringDesc* Command_62232) {
NI Result_63612;
TY27434 Si_63613;
TY27436 Procinfo_63614;
NI Process_63615;
NI32 L_63616;
NI32 LOC2;
NI32 LOC5;
NI32 LOC7;
NI32 LOC10;
NI32 LOC11;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "execCmd";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63612 = 0;
memset((void*)&Si_63613, 0, sizeof(Si_63613));
memset((void*)&Procinfo_63614, 0, sizeof(Procinfo_63614));
Process_63615 = 0;
L_63616 = 0;
F.line = 384;F.filename = "osproc.nim";
Si_63613.Cb = ((NI32)chckRange(((NI)sizeof(TY27434)), ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 385;F.filename = "osproc.nim";
Si_63613.Hstderror = Dl_27540(((NI32) -12));
F.line = 386;F.filename = "osproc.nim";
Si_63613.Hstdinput = Dl_27540(((NI32) -10));
F.line = 387;F.filename = "osproc.nim";
Si_63613.Hstdoutput = Dl_27540(((NI32) -11));
F.line = 388;F.filename = "osproc.nim";
LOC2 = Dl_27505(NIM_NIL, Command_62232->data, NIM_NIL, NIM_NIL, ((NI32) 0), ((NI32) 32), NIM_NIL, NIM_NIL, &Si_63613, &Procinfo_63614);
if (!(((NI) (LOC2)) == 0)) goto LA3;
F.line = 390;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP62688));
goto LA1;
LA3: ;
F.line = 392;F.filename = "osproc.nim";
Process_63615 = Procinfo_63614.Hprocess;
F.line = 393;F.filename = "osproc.nim";
LOC5 = Dl_27475(Procinfo_63614.Hthread);
F.line = 394;F.filename = "osproc.nim";
LOC7 = Dl_27527(Process_63615, ((NI32) -1));
if (!!((((NI) (LOC7)) == -1))) goto LA8;
F.line = 395;F.filename = "osproc.nim";
LOC10 = Dl_27535(Process_63615, &L_63616);
F.line = 396;F.filename = "osproc.nim";
Result_63612 = ((NI) (L_63616));
goto LA6;
LA8: ;
F.line = 398;F.filename = "osproc.nim";
Result_63612 = -1;
LA6: ;
F.line = 399;F.filename = "osproc.nim";
LOC11 = Dl_27475(Process_63615);
LA1: ;
framePtr = framePtr->prev;
return Result_63612;
}
N_NIMCALL(TY4377*, HEX26_63435)(NimStringDesc** X_63439, NI X_63439Len0, NimStringDesc** Y_63440, NI Y_63440Len0) {
TY4377* Result_63442;
NI I_63492;
NI HEX3Atmp_63802;
NI Res_63804;
NI I_63510;
NI HEX3Atmp_63808;
NI Res_63810;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "&";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_63442 = 0;
F.line = 1112;F.filename = "system.nim";
Result_63442 = (TY4377*) newSeq(NTI4377, addInt(X_63439Len0, Y_63440Len0));
I_63492 = 0;
HEX3Atmp_63802 = 0;
F.line = 1113;F.filename = "system.nim";
HEX3Atmp_63802 = subInt(X_63439Len0, 1);
Res_63804 = 0;
F.line = 1021;F.filename = "system.nim";
Res_63804 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_63804 <= HEX3Atmp_63802)) goto LA1;
F.line = 1021;F.filename = "system.nim";
I_63492 = Res_63804;
F.line = 1114;F.filename = "system.nim";
if ((NU)(I_63492) >= (NU)(Result_63442->Sup.len)) raiseIndexError();
if ((NU)(I_63492) >= (NU)(X_63439Len0)) raiseIndexError();
asgnRefNoCycle((void**) &Result_63442->data[I_63492], copyString(X_63439[I_63492]));
F.line = 1024;F.filename = "system.nim";
Res_63804 = addInt(Res_63804, 1);
} LA1: ;
I_63510 = 0;
HEX3Atmp_63808 = 0;
F.line = 1115;F.filename = "system.nim";
HEX3Atmp_63808 = subInt(Y_63440Len0, 1);
Res_63810 = 0;
F.line = 1021;F.filename = "system.nim";
Res_63810 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_63810 <= HEX3Atmp_63808)) goto LA2;
F.line = 1021;F.filename = "system.nim";
I_63510 = Res_63810;
F.line = 1116;F.filename = "system.nim";
if ((NU)(addInt(I_63510, X_63439Len0)) >= (NU)(Result_63442->Sup.len)) raiseIndexError();
if ((NU)(I_63510) >= (NU)(Y_63440Len0)) raiseIndexError();
asgnRefNoCycle((void**) &Result_63442->data[addInt(I_63510, X_63439Len0)], copyString(Y_63440[I_63510]));
F.line = 1024;F.filename = "system.nim";
Res_63810 = addInt(Res_63810, 1);
} LA2: ;
framePtr = framePtr->prev;
return Result_63442;
}
N_NOINLINE(void, osprocInit)(void) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "osproc";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
framePtr = framePtr->prev;
}

