/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

#include <errno.h>
#include <string.h>
typedef struct TY4377 TY4377;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY10602 TY10602;
typedef struct TY8004 TY8004;
typedef struct TY10990 TY10990;
typedef struct TY10618 TY10618;
typedef struct TY10614 TY10614;
typedef struct TY10610 TY10610;
typedef struct TY10988 TY10988;
typedef struct TY33378 TY33378;
typedef struct TY33515 TY33515;
typedef struct TY422 TY422;
typedef struct TY418 TY418;
typedef struct TY416 TY416;
typedef struct E_Base E_Base;
typedef struct TNimObject TNimObject;
typedef struct TY27598 TY27598;
typedef struct TY27596 TY27596;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY10602 {
NI Refcount;
TNimType* Typ;
};
typedef N_STDCALL_PTR(void, TY8016) (TY8004* L_8018);
struct TY10618 {
NI Len;
NI Cap;
TY10602** D;
};
struct TY10614 {
NI Counter;
NI Max;
TY10610* Head;
TY10610** Data;
};
struct TY8004 {
void* Debuginfo;
NI32 Lockcount;
NI32 Recursioncount;
NI Owningthread;
NI Locksemaphore;
NI32 Reserved;
};
struct TY10988 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY10990 {
TY10618 Zct;
TY10618 Decstack;
TY10614 Cycleroots;
TY10618 Tempstack;
TY8004 Cyclerootslock;
TY8004 Zctlock;
TY10988 Stat;
};
typedef N_STDCALL_PTR(void, TY8020) (TY8004* L_8022);
typedef N_STDCALL_PTR(NCSTRING, TY27648) (void);
typedef N_STDCALL_PTR(NI32, TY27650) (NCSTRING Para1_27651);
struct TY33378 {
NimStringDesc* Head;
NimStringDesc* Tail;
};
struct TY33515 {
NimStringDesc* Dir;
NimStringDesc* Name;
NimStringDesc* Ext;
};
typedef N_STDCALL_PTR(NI32, TY27583) (NI Handle_27584, NCSTRING Buf_27585, NI32 Size_27586);
typedef N_STDCALL_PTR(NI32, TY27565) (NI32 Nbufferlength_27566, NCSTRING Lpbuffer_27567);
typedef N_STDCALL_PTR(NI32, TY27551) (void);
typedef N_STDCALL_PTR(NI32, TY27553) (NI32 Dwflags_27554, void* Lpsource_27555, NI32 Dwmessageid_27556, NI32 Dwlanguageid_27557, void* Lpbuffer_27558, NI32 Nsize_27559, void* Arguments_27560);
typedef N_STDCALL_PTR(void, TY27562) (void* P_27563);
struct TNimObject {
TNimType* m_type;
};
struct E_Base {
  TNimObject Sup;
E_Base* parent;
NCSTRING name;
NimStringDesc* message;
};
struct TY416 {
  E_Base Sup;
};
struct TY418 {
  TY416 Sup;
};
struct TY422 {
  TY418 Sup;
};
typedef N_STDCALL_PTR(NI32, TY27572) (NCSTRING Pathname_27573, void* Security_27574);
typedef N_STDCALL_PTR(NI32, TY27636) (NCSTRING Lpfilename_27637);
typedef N_STDCALL_PTR(void, TY27667) (NI32 Dwmilliseconds_27668);
typedef N_STDCALL_PTR(NI32, TY27579) (NCSTRING Lpname_27580, NCSTRING Lpvalue_27581);
struct TY27596 {
NI32 Dwlowdatetime;
NI32 Dwhighdatetime;
};
typedef NIM_CHAR TY27609[260];
typedef NIM_CHAR TY27612[14];
struct TY27598 {
NI32 Dwfileattributes;
TY27596 Ftcreationtime;
TY27596 Ftlastaccesstime;
TY27596 Ftlastwritetime;
NI32 Nfilesizehigh;
NI32 Nfilesizelow;
NI32 Dwreserved0;
NI32 Dwreserved1;
TY27609 Cfilename;
TY27612 Calternatefilename;
};
typedef N_STDCALL_PTR(NI, TY27616) (NCSTRING Lpfilename_27617, TY27598* Lpfindfiledata_27619);
typedef N_STDCALL_PTR(void, TY27626) (NI Hfindfile_27627);
typedef N_STDCALL_PTR(NCSTRING, TY27653) (void);
typedef NI TY8614[8];
struct TY10610 {
TY10610* Next;
NI Key;
TY8614 Bits;
};
struct TY4377 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
N_NIMCALL(void*, newSeq)(TNimType* Typ_12804, NI Len_12805);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11818, void* Src_11819);
static N_INLINE(TY10602*, Usrtocell_11036)(void* Usr_11038);
static N_INLINE(NI, Atomicinc_3001)(NI* Memloc_3004, NI X_3005);
static N_INLINE(NI, Atomicdec_3006)(NI* Memloc_3009, NI X_3010);
static N_INLINE(void, Rtladdzct_11658)(TY10602* C_11660);
N_NOINLINE(void, Addzct_11025)(TY10618* S_11028, TY10602* C_11029);
N_NIMCALL(NI, Findenvvar_34402)(NimStringDesc* Key_34404);
N_NIMCALL(void, Getenvvarsc_34243)(void);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING Str_17304);
N_NIMCALL(TGenericSeq*, incrSeq)(TGenericSeq* Seq_17435, NI Elemsize_17436);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_17308);
static N_INLINE(NI, addInt)(NI A_5803, NI B_5804);
N_NOINLINE(void, raiseOverflow)(void);
static N_INLINE(void, appendString)(NimStringDesc* Dest_17392, NimStringDesc* Src_17393);
static N_INLINE(void, appendChar)(NimStringDesc* Dest_17409, NIM_CHAR C_17410);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_17287);
N_NIMCALL(NIM_BOOL, nsuStartsWith)(NimStringDesc* S_24769, NimStringDesc* Prefix_24770);
N_NOINLINE(void, raiseIndexError)(void);
N_NIMCALL(NimStringDesc*, copyStr)(NimStringDesc* S_1924, NI First_1925);
N_NIMCALL(NI, nsuFindChar)(NimStringDesc* S_25227, NIM_CHAR Sub_25228, NI Start_25229);
N_NIMCALL(NI, Searchextpos_33478)(NimStringDesc* S_33480);
static N_INLINE(NI, subInt)(NI A_6003, NI B_6004);
N_NIMCALL(NimStringDesc*, Normext_33468)(NimStringDesc* Ext_33470);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* S_1928, NI First_1929, NI Last_1930);
N_NIMCALL(void, unsureAsgnRef)(void** Dest_11826, void* Src_11827);
N_NIMCALL(void, nossplitFile)(NimStringDesc* Path_33514, TY33515* Result);
N_NIMCALL(NimStringDesc*, nosgetApplicationFilename)(void);
N_NIMCALL(NimStringDesc*, mnewString)(NI Len_1349);
N_NIMCALL(NimStringDesc*, setLengthStr)(NimStringDesc* S_17425, NI Newlen_17426);
N_NOINLINE(void, nosOSError)(NimStringDesc* Msg_31004);
N_NIMCALL(void*, newObj)(TNimType* Typ_12307, NI Size_12308);
N_NIMCALL(void, raiseException)(E_Base* E_5204, NCSTRING Ename_5205);
N_NIMCALL(NimStringDesc*, nosJoinPath)(NimStringDesc* Head_33203, NimStringDesc* Tail_33204);
N_NIMCALL(void, Rawcreatedir_35219)(NimStringDesc* Dir_35221);
N_NIMCALL(void, nosSplitPath)(NimStringDesc* Path_33377, TY33378* Result);
static N_INLINE(NI, divInt)(NI A_6403, NI B_6404);
N_NOINLINE(void, raiseDivByZero)(void);
N_NIMCALL(NimStringDesc*, addChar)(NimStringDesc* S_1603, NIM_CHAR C_1604);
static N_INLINE(NI, modInt)(NI A_6603, NI B_6604);
static N_INLINE(NI, chckRange)(NI I_4610, NI A_4611, NI B_4612);
N_NOINLINE(void, raiseRangeError)(NI64 Val_5418);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* Dest_17382, NI Addlen_17383);
N_NIMCALL(NimStringDesc*, Getenv_34425)(NimStringDesc* Key_34427);
static N_INLINE(NIM_BOOL, eqStrings)(NimStringDesc* A_17247, NimStringDesc* B_17248);
N_NIMCALL(NI, noscmpPaths)(NimStringDesc* Patha_33865, NimStringDesc* Pathb_33866);
N_NIMCALL(NI, Cmp_1321)(NimStringDesc* X_1323, NimStringDesc* Y_1324);
N_NIMCALL(NI, nsuCmpIgnoreCase)(NimStringDesc* A_23595, NimStringDesc* B_23596);
N_NIMCALL(NI64, ntDiffTime)(NI32 A_28435, NI32 B_28436);
N_NIMCALL(NI32, nosgetLastModificationTime)(NimStringDesc* File_32203);
N_NIMCALL(NI32, Wintimetounixtime_29261)(NI64 T_29263);
N_NIMCALL(NI64, Rdfiletime_27654)(TY27596 F_27656);
N_NIMCALL(TY4377*, nosparseCmdLine)(NimStringDesc* C_35434);
STRING_LITERAL(TMP40351, "", 0);
STRING_LITERAL(TMP41220, "unknown OS error", 16);
STRING_LITERAL(TMP68416, "C:\\", 3);
STRING_LITERAL(TMP68417, ".", 1);
STRING_LITERAL(TMP68418, "..\\", 3);
STRING_LITERAL(TMP75535, "APPDATA", 7);
STRING_LITERAL(TMP75536, "\\", 1);
NIM_BOOL Envcomputed_34220;
TY4377* Environment_34238;
extern TNimType* NTI4377; /* seq[string] */
extern TY8016 Dl_8015;
extern TY10990 Gch_11010;
extern TY8020 Dl_8019;
TY4377* Ownargv_36402;
extern TY27648 Dl_27647;
extern TY27650 Dl_27649;
extern TY27583 Dl_27582;
extern TY27565 Dl_27564;
extern TY27551 Dl_27550;
extern TY27553 Dl_27552;
extern TY27562 Dl_27561;
extern TNimType* NTI31017; /* ref EOS */
extern TNimType* NTI422; /* EOS */
extern TY27572 Dl_27571;
extern TY27636 Dl_27635;
extern TY27667 Dl_27666;
extern TY27579 Dl_27578;
extern TY27616 Dl_27615;
extern TY27626 Dl_27625;
extern TY27653 Dl_27652;
static N_INLINE(TY10602*, Usrtocell_11036)(void* Usr_11038) {
TY10602* Result_11039;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "usrToCell";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_11039 = 0;
F.line = 100;F.filename = "gc.nim";
Result_11039 = ((TY10602*) ((NI64)((NU64)(((NI) (Usr_11038))) - (NU64)(((NI) (((NI)sizeof(TY10602))))))));
framePtr = framePtr->prev;
return Result_11039;
}
static N_INLINE(NI, Atomicinc_3001)(NI* Memloc_3004, NI X_3005) {
NI Result_7408;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicInc";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7408 = 0;
F.line = 29;F.filename = "systhread.nim";
Result_7408 = __sync_add_and_fetch(Memloc_3004, X_3005);
framePtr = framePtr->prev;
return Result_7408;
}
static N_INLINE(NI, Atomicdec_3006)(NI* Memloc_3009, NI X_3010) {
NI Result_7606;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicDec";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7606 = 0;
F.line = 37;F.filename = "systhread.nim";
Result_7606 = __sync_sub_and_fetch(Memloc_3009, X_3010);
framePtr = framePtr->prev;
return Result_7606;
}
static N_INLINE(void, Rtladdzct_11658)(TY10602* C_11660) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "rtlAddZCT";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 211;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA2;
F.line = 211;F.filename = "gc.nim";
Dl_8015(&Gch_11010.Zctlock);
LA2: ;
F.line = 212;F.filename = "gc.nim";
Addzct_11025(&Gch_11010.Zct, C_11660);
F.line = 213;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA5;
F.line = 213;F.filename = "gc.nim";
Dl_8019(&Gch_11010.Zctlock);
LA5: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11818, void* Src_11819) {
TY10602* C_11820;
NI LOC4;
TY10602* C_11822;
NI LOC9;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "asgnRefNoCycle";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 244;F.filename = "gc.nim";
if (!!((Src_11819 == NIM_NIL))) goto LA2;
C_11820 = 0;
F.line = 245;F.filename = "gc.nim";
C_11820 = Usrtocell_11036(Src_11819);
F.line = 246;F.filename = "gc.nim";
LOC4 = Atomicinc_3001(&(*C_11820).Refcount, 8);
LA2: ;
F.line = 247;F.filename = "gc.nim";
if (!!(((*Dest_11818) == NIM_NIL))) goto LA6;
C_11822 = 0;
F.line = 248;F.filename = "gc.nim";
C_11822 = Usrtocell_11036((*Dest_11818));
F.line = 249;F.filename = "gc.nim";
LOC9 = Atomicdec_3006(&(*C_11822).Refcount, 8);
if (!((NU64)(LOC9) < (NU64)(8))) goto LA10;
F.line = 250;F.filename = "gc.nim";
Rtladdzct_11658(C_11822);
LA10: ;
LA6: ;
F.line = 251;F.filename = "gc.nim";
(*Dest_11818) = Src_11819;
framePtr = framePtr->prev;
}
static N_INLINE(NI, addInt)(NI A_5803, NI B_5804) {
NI Result_5805;
NIM_BOOL LOC2;
Result_5805 = 0;
Result_5805 = (NI64)((NU64)(A_5803) + (NU64)(B_5804));
LOC2 = (0 <= (NI64)(Result_5805 ^ A_5803));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5805 ^ B_5804));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5805;
}
N_NIMCALL(void, Getenvvarsc_34243)(void) {
NCSTRING Env_34245;
NCSTRING E_34246;
NCSTRING Eend_34247;
NimStringDesc* LOC8;
NI32 LOC12;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getEnvVarsC";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 692;F.filename = "os.nim";
if (!!(Envcomputed_34220)) goto LA2;
Env_34245 = 0;
F.line = 694;F.filename = "os.nim";
Env_34245 = Dl_27647();
E_34246 = 0;
F.line = 695;F.filename = "os.nim";
E_34246 = Env_34245;
F.line = 696;F.filename = "os.nim";
if (!(E_34246 == NIM_NIL)) goto LA5;
F.line = 696;F.filename = "os.nim";
goto BeforeRet;
LA5: ;
F.line = 697;F.filename = "os.nim";
while (1) {
Eend_34247 = 0;
F.line = 698;F.filename = "os.nim";
Eend_34247 = strchr(E_34246, ((NI32) 0));
F.line = 699;F.filename = "os.nim";
LOC8 = 0;
LOC8 = cstrToNimstr(E_34246);
Environment_34238 = (TY4377*) incrSeq(&(Environment_34238)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &Environment_34238->data[Environment_34238->Sup.len-1], copyString(LOC8));
F.line = 700;F.filename = "os.nim";
E_34246 = ((NCSTRING) (addInt(((NI) (Eend_34247)), 1)));
F.line = 701;F.filename = "os.nim";
if (!((NU8)(Eend_34247[1]) == (NU8)(0))) goto LA10;
F.line = 701;F.filename = "os.nim";
goto LA7;
LA10: ;
} LA7: ;
F.line = 702;F.filename = "os.nim";
Envcomputed_34220 = NIM_TRUE;
F.line = 703;F.filename = "os.nim";
LOC12 = Dl_27649(Env_34245);
LA2: ;
BeforeRet: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_17392, NimStringDesc* Src_17393) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendString";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 150;F.filename = "sysstr.nim";
memcpy(((NCSTRING) (&(*Dest_17392).data[((*Dest_17392).Sup.len)-0])), ((NCSTRING) ((*Src_17393).data)), ((NI32) ((NI64)((NI64)((*Src_17393).Sup.len + 1) * 1))));
F.line = 151;F.filename = "sysstr.nim";
(*Dest_17392).Sup.len += (*Src_17393).Sup.len;
framePtr = framePtr->prev;
}
static N_INLINE(void, appendChar)(NimStringDesc* Dest_17409, NIM_CHAR C_17410) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendChar";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 154;F.filename = "sysstr.nim";
(*Dest_17409).data[((*Dest_17409).Sup.len)-0] = C_17410;
F.line = 155;F.filename = "sysstr.nim";
(*Dest_17409).data[((NI64)((*Dest_17409).Sup.len + 1))-0] = 0;
F.line = 156;F.filename = "sysstr.nim";
(*Dest_17409).Sup.len += 1;
framePtr = framePtr->prev;
}
N_NIMCALL(NI, Findenvvar_34402)(NimStringDesc* Key_34404) {
NI Result_34405;
NimStringDesc* Temp_34410;
NimStringDesc* LOC1;
NI I_34418;
NI HEX3Atmp_34420;
NI Res_34422;
NIM_BOOL LOC4;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "findEnvVar";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_34405 = 0;
F.line = 720;F.filename = "os.nim";
Getenvvarsc_34243();
Temp_34410 = 0;
F.line = 721;F.filename = "os.nim";
LOC1 = 0;
LOC1 = rawNewString(Key_34404->Sup.len + 1);
appendString(LOC1, Key_34404);
appendChar(LOC1, 61);
Temp_34410 = LOC1;
I_34418 = 0;
HEX3Atmp_34420 = 0;
F.line = 722;F.filename = "os.nim";
HEX3Atmp_34420 = (Environment_34238->Sup.len-1);
Res_34422 = 0;
F.line = 1021;F.filename = "system.nim";
Res_34422 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_34422 <= HEX3Atmp_34420)) goto LA2;
F.line = 1021;F.filename = "system.nim";
I_34418 = Res_34422;
F.line = 723;F.filename = "os.nim";
if ((NU)(I_34418) >= (NU)(Environment_34238->Sup.len)) raiseIndexError();
LOC4 = nsuStartsWith(Environment_34238->data[I_34418], Temp_34410);
if (!LOC4) goto LA5;
F.line = 723;F.filename = "os.nim";
F.line = 723;F.filename = "os.nim";
Result_34405 = I_34418;
goto BeforeRet;
LA5: ;
F.line = 1024;F.filename = "system.nim";
Res_34422 = addInt(Res_34422, 1);
} LA2: ;
F.line = 724;F.filename = "os.nim";
F.line = 724;F.filename = "os.nim";
Result_34405 = -1;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_34405;
}
N_NIMCALL(NimStringDesc*, Getenv_34425)(NimStringDesc* Key_34427) {
NimStringDesc* Result_34428;
NI I_34429;
NI LOC4;
NCSTRING Env_34432;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getEnv";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_34428 = 0;
I_34429 = 0;
F.line = 732;F.filename = "os.nim";
I_34429 = Findenvvar_34402(Key_34427);
F.line = 733;F.filename = "os.nim";
if (!(0 <= I_34429)) goto LA2;
F.line = 734;F.filename = "os.nim";
F.line = 734;F.filename = "os.nim";
if ((NU)(I_34429) >= (NU)(Environment_34238->Sup.len)) raiseIndexError();
if ((NU)(I_34429) >= (NU)(Environment_34238->Sup.len)) raiseIndexError();
LOC4 = nsuFindChar(Environment_34238->data[I_34429], 61, 0);
Result_34428 = copyStr(Environment_34238->data[I_34429], addInt(LOC4, 1));
goto BeforeRet;
goto LA1;
LA2: ;
Env_34432 = 0;
F.line = 736;F.filename = "os.nim";
Env_34432 = getenv(Key_34427->data);
F.line = 737;F.filename = "os.nim";
if (!(Env_34432 == NIM_NIL)) goto LA6;
F.line = 737;F.filename = "os.nim";
F.line = 737;F.filename = "os.nim";
Result_34428 = copyString(((NimStringDesc*) &TMP40351));
goto BeforeRet;
LA6: ;
F.line = 738;F.filename = "os.nim";
Result_34428 = cstrToNimstr(Env_34432);
LA1: ;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_34428;
}
static N_INLINE(NI, subInt)(NI A_6003, NI B_6004) {
NI Result_6005;
NIM_BOOL LOC2;
Result_6005 = 0;
Result_6005 = (NI64)((NU64)(A_6003) - (NU64)(B_6004));
LOC2 = (0 <= (NI64)(Result_6005 ^ A_6003));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_6005 ^ (NI64)((NU64) ~(B_6004))));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_6005;
}
N_NIMCALL(NI, Searchextpos_33478)(NimStringDesc* S_33480) {
NI Result_33481;
NI I_33491;
NI HEX3Atmp_33507;
NI Res_33509;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "searchExtPos";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33481 = 0;
F.line = 424;F.filename = "os.nim";
Result_33481 = -1;
I_33491 = 0;
HEX3Atmp_33507 = 0;
F.line = 425;F.filename = "os.nim";
HEX3Atmp_33507 = subInt(S_33480->Sup.len, 1);
Res_33509 = 0;
F.line = 1012;F.filename = "system.nim";
Res_33509 = HEX3Atmp_33507;
F.line = 1013;F.filename = "system.nim";
while (1) {
if (!(1 <= Res_33509)) goto LA1;
F.line = 1012;F.filename = "system.nim";
I_33491 = Res_33509;
F.line = 426;F.filename = "os.nim";
if ((NU)(I_33491) > (NU)(S_33480->Sup.len)) raiseIndexError();
if (!((NU8)(S_33480->data[I_33491]) == (NU8)(46))) goto LA3;
F.line = 427;F.filename = "os.nim";
Result_33481 = I_33491;
F.line = 428;F.filename = "os.nim";
goto LA1;
goto LA2;
LA3: ;
if ((NU)(I_33491) > (NU)(S_33480->Sup.len)) raiseIndexError();
if (!(((NU8)(S_33480->data[I_33491])) == ((NU8)(92)) || ((NU8)(S_33480->data[I_33491])) == ((NU8)(47)))) goto LA5;
F.line = 430;F.filename = "os.nim";
goto LA1;
goto LA2;
LA5: ;
LA2: ;
F.line = 1015;F.filename = "system.nim";
Res_33509 = subInt(Res_33509, 1);
} LA1: ;
framePtr = framePtr->prev;
return Result_33481;
}
N_NIMCALL(NimStringDesc*, Normext_33468)(NimStringDesc* Ext_33470) {
NimStringDesc* Result_33471;
NIM_BOOL LOC2;
NimStringDesc* LOC6;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "normExt";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33471 = 0;
F.line = 419;F.filename = "os.nim";
LOC2 = ((Ext_33470) && (Ext_33470)->Sup.len == 0);
if (LOC2) goto LA3;
if ((NU)(0) > (NU)(Ext_33470->Sup.len)) raiseIndexError();
LOC2 = ((NU8)(Ext_33470->data[0]) == (NU8)(46));
LA3: ;
if (!LOC2) goto LA4;
F.line = 419;F.filename = "os.nim";
Result_33471 = copyString(Ext_33470);
goto LA1;
LA4: ;
F.line = 420;F.filename = "os.nim";
LOC6 = 0;
LOC6 = rawNewString(Ext_33470->Sup.len + 1);
appendChar(LOC6, 46);
appendString(LOC6, Ext_33470);
Result_33471 = LOC6;
LA1: ;
framePtr = framePtr->prev;
return Result_33471;
}
N_NIMCALL(NimStringDesc*, nosChangeFileExt)(NimStringDesc* Filename_33820, NimStringDesc* Ext_33821) {
NimStringDesc* Result_33822;
NI Extpos_33823;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
NimStringDesc* LOC6;
NimStringDesc* LOC7;
NimStringDesc* LOC8;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "ChangeFileExt";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33822 = 0;
Extpos_33823 = 0;
F.line = 533;F.filename = "os.nim";
Extpos_33823 = Searchextpos_33478(Filename_33820);
F.line = 534;F.filename = "os.nim";
if (!(Extpos_33823 < 0)) goto LA2;
F.line = 534;F.filename = "os.nim";
LOC4 = 0;
LOC5 = 0;
LOC5 = Normext_33468(Ext_33821);
LOC4 = rawNewString(Filename_33820->Sup.len + LOC5->Sup.len + 0);
appendString(LOC4, Filename_33820);
appendString(LOC4, LOC5);
Result_33822 = LOC4;
goto LA1;
LA2: ;
F.line = 535;F.filename = "os.nim";
LOC6 = 0;
LOC7 = 0;
LOC7 = copyStrLast(Filename_33820, 0, subInt(Extpos_33823, 1));
LOC8 = 0;
LOC8 = Normext_33468(Ext_33821);
LOC6 = rawNewString(LOC7->Sup.len + LOC8->Sup.len + 0);
appendString(LOC6, LOC7);
appendString(LOC6, LOC8);
Result_33822 = LOC6;
LA1: ;
framePtr = framePtr->prev;
return Result_33822;
}
N_NIMCALL(void, nosSplitPath)(NimStringDesc* Path_33377, TY33378* Result) {
NI Seppos_33382;
NI I_33392;
NI HEX3Atmp_33408;
NI Res_33410;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "SplitPath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
memset((void*)Result, 0, sizeof((*Result)));
Seppos_33382 = 0;
F.line = 380;F.filename = "os.nim";
Seppos_33382 = -1;
I_33392 = 0;
HEX3Atmp_33408 = 0;
F.line = 381;F.filename = "os.nim";
HEX3Atmp_33408 = subInt(Path_33377->Sup.len, 1);
Res_33410 = 0;
F.line = 1012;F.filename = "system.nim";
Res_33410 = HEX3Atmp_33408;
F.line = 1013;F.filename = "system.nim";
while (1) {
if (!(0 <= Res_33410)) goto LA1;
F.line = 1012;F.filename = "system.nim";
I_33392 = Res_33410;
F.line = 382;F.filename = "os.nim";
if ((NU)(I_33392) > (NU)(Path_33377->Sup.len)) raiseIndexError();
if (!(((NU8)(Path_33377->data[I_33392])) == ((NU8)(92)) || ((NU8)(Path_33377->data[I_33392])) == ((NU8)(47)))) goto LA3;
F.line = 383;F.filename = "os.nim";
Seppos_33382 = I_33392;
F.line = 384;F.filename = "os.nim";
goto LA1;
LA3: ;
F.line = 1015;F.filename = "system.nim";
Res_33410 = subInt(Res_33410, 1);
} LA1: ;
F.line = 385;F.filename = "os.nim";
if (!(0 <= Seppos_33382)) goto LA6;
F.line = 386;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Head, copyStrLast(Path_33377, 0, subInt(Seppos_33382, 1)));
F.line = 387;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Tail, copyStr(Path_33377, addInt(Seppos_33382, 1)));
goto LA5;
LA6: ;
F.line = 389;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Head, copyString(((NimStringDesc*) &TMP40351)));
F.line = 390;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Tail, copyString(Path_33377));
LA5: ;
framePtr = framePtr->prev;
}
N_NIMCALL(void, nossplitFile)(NimStringDesc* Path_33514, TY33515* Result) {
NIM_BOOL LOC2;
NI Seppos_33539;
NI Dotpos_33542;
NI I_33552;
NI HEX3Atmp_33574;
NI Res_33576;
NIM_BOOL LOC11;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "splitFile";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
memset((void*)Result, 0, sizeof((*Result)));
F.line = 449;F.filename = "os.nim";
LOC2 = (Path_33514->Sup.len == 0);
if (LOC2) goto LA3;
if ((NU)(subInt(Path_33514->Sup.len, 1)) > (NU)(Path_33514->Sup.len)) raiseIndexError();
LOC2 = (((NU8)(Path_33514->data[subInt(Path_33514->Sup.len, 1)])) == ((NU8)(92)) || ((NU8)(Path_33514->data[subInt(Path_33514->Sup.len, 1)])) == ((NU8)(47)));
LA3: ;
if (!LOC2) goto LA4;
F.line = 450;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Dir, copyString(Path_33514));
unsureAsgnRef((void**) &(*Result).Name, copyString(((NimStringDesc*) &TMP40351)));
unsureAsgnRef((void**) &(*Result).Ext, copyString(((NimStringDesc*) &TMP40351)));
goto LA1;
LA4: ;
Seppos_33539 = 0;
F.line = 452;F.filename = "os.nim";
Seppos_33539 = -1;
Dotpos_33542 = 0;
F.line = 453;F.filename = "os.nim";
Dotpos_33542 = Path_33514->Sup.len;
I_33552 = 0;
HEX3Atmp_33574 = 0;
F.line = 454;F.filename = "os.nim";
HEX3Atmp_33574 = subInt(Path_33514->Sup.len, 1);
Res_33576 = 0;
F.line = 1012;F.filename = "system.nim";
Res_33576 = HEX3Atmp_33574;
F.line = 1013;F.filename = "system.nim";
while (1) {
if (!(0 <= Res_33576)) goto LA6;
F.line = 1012;F.filename = "system.nim";
I_33552 = Res_33576;
F.line = 455;F.filename = "os.nim";
if ((NU)(I_33552) > (NU)(Path_33514->Sup.len)) raiseIndexError();
if (!((NU8)(Path_33514->data[I_33552]) == (NU8)(46))) goto LA8;
F.line = 456;F.filename = "os.nim";
LOC11 = (Dotpos_33542 == Path_33514->Sup.len);
if (!(LOC11)) goto LA12;
LOC11 = (0 < I_33552);
LA12: ;
if (!LOC11) goto LA13;
F.line = 456;F.filename = "os.nim";
Dotpos_33542 = I_33552;
LA13: ;
goto LA7;
LA8: ;
if ((NU)(I_33552) > (NU)(Path_33514->Sup.len)) raiseIndexError();
if (!(((NU8)(Path_33514->data[I_33552])) == ((NU8)(92)) || ((NU8)(Path_33514->data[I_33552])) == ((NU8)(47)))) goto LA15;
F.line = 458;F.filename = "os.nim";
Seppos_33539 = I_33552;
F.line = 459;F.filename = "os.nim";
goto LA6;
goto LA7;
LA15: ;
LA7: ;
F.line = 1015;F.filename = "system.nim";
Res_33576 = subInt(Res_33576, 1);
} LA6: ;
F.line = 460;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Dir, copyStrLast(Path_33514, 0, subInt(Seppos_33539, 1)));
F.line = 461;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Name, copyStrLast(Path_33514, addInt(Seppos_33539, 1), subInt(Dotpos_33542, 1)));
F.line = 462;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Ext, copyStr(Path_33514, Dotpos_33542));
LA1: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nosgetApplicationFilename)(void) {
NimStringDesc* Result_37003;
NI32 Len_37004;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getApplicationFilename";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37003 = 0;
F.line = 1182;F.filename = "os.nim";
Result_37003 = mnewString(256);
Len_37004 = 0;
F.line = 1183;F.filename = "os.nim";
Len_37004 = Dl_27582(0, Result_37003->data, ((NI32) 256));
F.line = 1184;F.filename = "os.nim";
Result_37003 = setLengthStr(Result_37003, ((NI) (Len_37004)));
framePtr = framePtr->prev;
return Result_37003;
}
N_NIMCALL(NimStringDesc*, nosgetApplicationDir)(void) {
NimStringDesc* Result_37203;
NimStringDesc* LOC1;
TY33515 LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getApplicationDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37203 = 0;
F.line = 1211;F.filename = "os.nim";
LOC1 = 0;
LOC1 = nosgetApplicationFilename();
memset((void*)&LOC2, 0, sizeof(LOC2));
nossplitFile(LOC1, &LOC2);
Result_37203 = copyString(LOC2.Dir);
framePtr = framePtr->prev;
return Result_37203;
}
N_NOINLINE(void, nosOSError)(NimStringDesc* Msg_31004) {
NI32 Err_31009;
NCSTRING Msgbuf_31012;
NI32 LOC8;
NimStringDesc* M_31016;
TY422* E_31018;
TY422* E_31204;
NCSTRING LOC19;
TY422* E_31221;
TY422* E_31238;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "OSError";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 156;F.filename = "os.nim";
if (!(Msg_31004->Sup.len == 0)) goto LA2;
Err_31009 = 0;
F.line = 158;F.filename = "os.nim";
Err_31009 = Dl_27550();
F.line = 159;F.filename = "os.nim";
if (!!((Err_31009 == ((NI32) 0)))) goto LA5;
Msgbuf_31012 = 0;
F.line = 162;F.filename = "os.nim";
LOC8 = Dl_27552(((NI32) 4864), NIM_NIL, Err_31009, ((NI32) 0), ((void*) (&Msgbuf_31012)), ((NI32) 0), NIM_NIL);
if (!!((LOC8 == ((NI32) 0)))) goto LA9;
M_31016 = 0;
F.line = 164;F.filename = "os.nim";
M_31016 = cstrToNimstr(Msgbuf_31012);
F.line = 165;F.filename = "os.nim";
if (!!((Msgbuf_31012 == NIM_NIL))) goto LA12;
F.line = 166;F.filename = "os.nim";
Dl_27561(((void*) (Msgbuf_31012)));
LA12: ;
E_31018 = 0;
F.line = 1280;F.filename = "system.nim";
E_31018 = (TY422*) newObj(NTI31017, sizeof(TY422));
(*E_31018).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1281;F.filename = "system.nim";
asgnRefNoCycle((void**) &(*E_31018).Sup.Sup.Sup.message, copyString(M_31016));
F.line = 167;F.filename = "os.nim";
raiseException((E_Base*)E_31018, "EOS");
LA9: ;
LA5: ;
F.line = 168;F.filename = "os.nim";
if (!!((errno == ((NI32) 0)))) goto LA16;
E_31204 = 0;
F.line = 1280;F.filename = "system.nim";
E_31204 = (TY422*) newObj(NTI31017, sizeof(TY422));
(*E_31204).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1281;F.filename = "system.nim";
LOC19 = strerror(errno);
asgnRefNoCycle((void**) &(*E_31204).Sup.Sup.Sup.message, cstrToNimstr(LOC19));
F.line = 169;F.filename = "os.nim";
raiseException((E_Base*)E_31204, "EOS");
goto LA15;
LA16: ;
E_31221 = 0;
F.line = 1280;F.filename = "system.nim";
E_31221 = (TY422*) newObj(NTI31017, sizeof(TY422));
(*E_31221).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1281;F.filename = "system.nim";
asgnRefNoCycle((void**) &(*E_31221).Sup.Sup.Sup.message, copyString(((NimStringDesc*) &TMP41220)));
F.line = 171;F.filename = "os.nim";
raiseException((E_Base*)E_31221, "EOS");
LA15: ;
goto LA1;
LA2: ;
E_31238 = 0;
F.line = 1280;F.filename = "system.nim";
E_31238 = (TY422*) newObj(NTI31017, sizeof(TY422));
(*E_31238).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1281;F.filename = "system.nim";
asgnRefNoCycle((void**) &(*E_31238).Sup.Sup.Sup.message, copyString(Msg_31004));
F.line = 173;F.filename = "os.nim";
raiseException((E_Base*)E_31238, "EOS");
LA1: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nosgetCurrentDir)(void) {
NimStringDesc* Result_32810;
NI32 L_32812;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getCurrentDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32810 = 0;
F.line = 289;F.filename = "os.nim";
Result_32810 = mnewString(512);
L_32812 = 0;
F.line = 291;F.filename = "os.nim";
L_32812 = Dl_27564(((NI32) 512), Result_32810->data);
F.line = 292;F.filename = "os.nim";
if (!(L_32812 == ((NI32) 0))) goto LA2;
F.line = 292;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP40351));
LA2: ;
F.line = 293;F.filename = "os.nim";
Result_32810 = setLengthStr(Result_32810, ((NI) (L_32812)));
framePtr = framePtr->prev;
return Result_32810;
}
N_NIMCALL(NimStringDesc*, nosJoinPath)(NimStringDesc* Head_33203, NimStringDesc* Tail_33204) {
NimStringDesc* Result_33205;
NimStringDesc* LOC9;
NimStringDesc* LOC10;
NimStringDesc* LOC11;
NimStringDesc* LOC15;
NimStringDesc* LOC16;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "JoinPath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33205 = 0;
F.line = 324;F.filename = "os.nim";
if (!(Head_33203->Sup.len == 0)) goto LA2;
F.line = 325;F.filename = "os.nim";
Result_33205 = copyString(Tail_33204);
goto LA1;
LA2: ;
if ((NU)(subInt(Head_33203->Sup.len, 1)) > (NU)(Head_33203->Sup.len)) raiseIndexError();
if (!(((NU8)(Head_33203->data[subInt(Head_33203->Sup.len, 1)])) == ((NU8)(92)) || ((NU8)(Head_33203->data[subInt(Head_33203->Sup.len, 1)])) == ((NU8)(47)))) goto LA4;
F.line = 327;F.filename = "os.nim";
if ((NU)(0) > (NU)(Tail_33204->Sup.len)) raiseIndexError();
if (!(((NU8)(Tail_33204->data[0])) == ((NU8)(92)) || ((NU8)(Tail_33204->data[0])) == ((NU8)(47)))) goto LA7;
F.line = 328;F.filename = "os.nim";
LOC9 = 0;
LOC10 = 0;
LOC10 = copyStr(Tail_33204, 1);
LOC9 = rawNewString(Head_33203->Sup.len + LOC10->Sup.len + 0);
appendString(LOC9, Head_33203);
appendString(LOC9, LOC10);
Result_33205 = LOC9;
goto LA6;
LA7: ;
F.line = 330;F.filename = "os.nim";
LOC11 = 0;
LOC11 = rawNewString(Head_33203->Sup.len + Tail_33204->Sup.len + 0);
appendString(LOC11, Head_33203);
appendString(LOC11, Tail_33204);
Result_33205 = LOC11;
LA6: ;
goto LA1;
LA4: ;
F.line = 332;F.filename = "os.nim";
if ((NU)(0) > (NU)(Tail_33204->Sup.len)) raiseIndexError();
if (!(((NU8)(Tail_33204->data[0])) == ((NU8)(92)) || ((NU8)(Tail_33204->data[0])) == ((NU8)(47)))) goto LA13;
F.line = 333;F.filename = "os.nim";
LOC15 = 0;
LOC15 = rawNewString(Head_33203->Sup.len + Tail_33204->Sup.len + 0);
appendString(LOC15, Head_33203);
appendString(LOC15, Tail_33204);
Result_33205 = LOC15;
goto LA12;
LA13: ;
F.line = 335;F.filename = "os.nim";
LOC16 = 0;
LOC16 = rawNewString(Head_33203->Sup.len + Tail_33204->Sup.len + 1);
appendString(LOC16, Head_33203);
appendChar(LOC16, 92);
appendString(LOC16, Tail_33204);
Result_33205 = LOC16;
LA12: ;
LA1: ;
framePtr = framePtr->prev;
return Result_33205;
}
N_NIMCALL(NimStringDesc*, nosJoinPathOpenArray)(NimStringDesc** Parts_33287, NI Parts_33287Len0) {
NimStringDesc* Result_33288;
NI I_33311;
NI HEX3Atmp_33313;
NI Res_33315;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "JoinPath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33288 = 0;
F.line = 341;F.filename = "os.nim";
if ((NU)(0) >= (NU)(Parts_33287Len0)) raiseIndexError();
Result_33288 = copyString(Parts_33287[0]);
I_33311 = 0;
HEX3Atmp_33313 = 0;
F.line = 342;F.filename = "os.nim";
HEX3Atmp_33313 = (Parts_33287Len0-1);
Res_33315 = 0;
F.line = 1021;F.filename = "system.nim";
Res_33315 = 1;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_33315 <= HEX3Atmp_33313)) goto LA1;
F.line = 1021;F.filename = "system.nim";
I_33311 = Res_33315;
F.line = 343;F.filename = "os.nim";
if ((NU)(I_33311) >= (NU)(Parts_33287Len0)) raiseIndexError();
Result_33288 = nosJoinPath(Result_33288, Parts_33287[I_33311]);
F.line = 1024;F.filename = "system.nim";
Res_33315 = addInt(Res_33315, 1);
} LA1: ;
framePtr = framePtr->prev;
return Result_33288;
}
N_NIMCALL(void, Rawcreatedir_35219)(NimStringDesc* Dir_35221) {
NIM_BOOL LOC2;
NI32 LOC3;
NI32 LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "rawCreateDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 917;F.filename = "os.nim";
LOC3 = Dl_27571(Dir_35221->data, NIM_NIL);
LOC2 = (LOC3 == ((NI32) 0));
if (!(LOC2)) goto LA4;
LOC5 = Dl_27550();
LOC2 = !((LOC5 == ((NI32) 183)));
LA4: ;
if (!LOC2) goto LA6;
F.line = 918;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP40351));
LA6: ;
framePtr = framePtr->prev;
}
N_NIMCALL(void, noscreateDir)(NimStringDesc* Dir_35403) {
NI I_35413;
NI HEX3Atmp_35427;
NI Res_35429;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "createDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
I_35413 = 0;
HEX3Atmp_35427 = 0;
F.line = 927;F.filename = "os.nim";
HEX3Atmp_35427 = subInt(Dir_35403->Sup.len, 1);
Res_35429 = 0;
F.line = 1021;F.filename = "system.nim";
Res_35429 = 1;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_35429 <= HEX3Atmp_35427)) goto LA1;
F.line = 1021;F.filename = "system.nim";
I_35413 = Res_35429;
F.line = 928;F.filename = "os.nim";
if ((NU)(I_35413) > (NU)(Dir_35403->Sup.len)) raiseIndexError();
if (!(((NU8)(Dir_35403->data[I_35413])) == ((NU8)(92)) || ((NU8)(Dir_35403->data[I_35413])) == ((NU8)(47)))) goto LA3;
F.line = 928;F.filename = "os.nim";
LOC5 = 0;
LOC5 = copyStrLast(Dir_35403, 0, subInt(I_35413, 1));
Rawcreatedir_35219(LOC5);
LA3: ;
F.line = 1024;F.filename = "system.nim";
Res_35429 = addInt(Res_35429, 1);
} LA1: ;
F.line = 929;F.filename = "os.nim";
Rawcreatedir_35219(Dir_35403);
framePtr = framePtr->prev;
}
N_NIMCALL(NIM_BOOL, nosexistsFile)(NimStringDesc* Filename_31804) {
NIM_BOOL Result_31805;
NI32 A_31806;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "existsFile";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_31805 = 0;
A_31806 = 0;
F.line = 224;F.filename = "os.nim";
A_31806 = Dl_27635(Filename_31804->data);
F.line = 225;F.filename = "os.nim";
if (!!((A_31806 == ((NI32) -1)))) goto LA2;
F.line = 226;F.filename = "os.nim";
Result_31805 = ((NI32)(A_31806 & ((NI32) 16)) == ((NI32) 0));
LA2: ;
framePtr = framePtr->prev;
return Result_31805;
}
N_NIMCALL(NimStringDesc*, nosextractFilename)(NimStringDesc* Path_33585) {
NimStringDesc* Result_33586;
NIM_BOOL LOC2;
TY33378 LOC6;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "extractFilename";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33586 = 0;
F.line = 475;F.filename = "os.nim";
LOC2 = (Path_33585->Sup.len == 0);
if (LOC2) goto LA3;
if ((NU)(subInt(Path_33585->Sup.len, 1)) > (NU)(Path_33585->Sup.len)) raiseIndexError();
LOC2 = (((NU8)(Path_33585->data[subInt(Path_33585->Sup.len, 1)])) == ((NU8)(92)) || ((NU8)(Path_33585->data[subInt(Path_33585->Sup.len, 1)])) == ((NU8)(47)));
LA3: ;
if (!LOC2) goto LA4;
F.line = 476;F.filename = "os.nim";
Result_33586 = copyString(((NimStringDesc*) &TMP40351));
goto LA1;
LA4: ;
F.line = 478;F.filename = "os.nim";
memset((void*)&LOC6, 0, sizeof(LOC6));
nosSplitPath(Path_33585, &LOC6);
Result_33586 = copyString(LOC6.Tail);
LA1: ;
framePtr = framePtr->prev;
return Result_33586;
}
static N_INLINE(NI, divInt)(NI A_6403, NI B_6404) {
NI Result_6405;
NIM_BOOL LOC5;
Result_6405 = 0;
if (!(B_6404 == 0)) goto LA2;
raiseDivByZero();
LA2: ;
LOC5 = (A_6403 == (IL64(-9223372036854775807) - IL64(1)));
if (!(LOC5)) goto LA6;
LOC5 = (B_6404 == -1);
LA6: ;
if (!LOC5) goto LA7;
raiseOverflow();
LA7: ;
Result_6405 = (NI64)(A_6403 / B_6404);
goto BeforeRet;
BeforeRet: ;
return Result_6405;
}
static N_INLINE(NI, modInt)(NI A_6603, NI B_6604) {
NI Result_6605;
Result_6605 = 0;
if (!(B_6604 == 0)) goto LA2;
raiseDivByZero();
LA2: ;
Result_6605 = (NI64)(A_6603 % B_6604);
goto BeforeRet;
BeforeRet: ;
return Result_6605;
}
N_NIMCALL(TY4377*, nosparseCmdLine)(NimStringDesc* C_35434) {
TY4377* Result_35436;
NI I_35453;
NimStringDesc* A_35454;
NIM_BOOL LOC3;
NIM_BOOL Inquote_35473;
NI J_35474;
NI K_35498;
NI HEX3Atmp_35622;
NI Res_35624;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "parseCmdLine";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_35436 = 0;
F.line = 962;F.filename = "os.nim";
Result_35436 = (TY4377*) newSeq(NTI4377, 0);
I_35453 = 0;
F.line = 963;F.filename = "os.nim";
I_35453 = 0;
A_35454 = 0;
F.line = 964;F.filename = "os.nim";
A_35454 = copyString(((NimStringDesc*) &TMP40351));
F.line = 965;F.filename = "os.nim";
while (1) {
F.line = 966;F.filename = "os.nim";
A_35454 = setLengthStr(A_35454, 0);
F.line = 967;F.filename = "os.nim";
while (1) {
if ((NU)(I_35453) > (NU)(C_35434->Sup.len)) raiseIndexError();
LOC3 = ((NU8)(C_35434->data[I_35453]) == (NU8)(32));
if (LOC3) goto LA4;
if ((NU)(I_35453) > (NU)(C_35434->Sup.len)) raiseIndexError();
LOC3 = ((NU8)(C_35434->data[I_35453]) == (NU8)(9));
LA4: ;
if (!LOC3) goto LA2;
F.line = 967;F.filename = "os.nim";
I_35453 = addInt(I_35453, 1);
} LA2: ;
F.line = 970;F.filename = "os.nim";
if ((NU)(I_35453) > (NU)(C_35434->Sup.len)) raiseIndexError();
if (!((NU8)(C_35434->data[I_35453]) == (NU8)(0))) goto LA6;
F.line = 970;F.filename = "os.nim";
goto LA1;
LA6: ;
Inquote_35473 = 0;
F.line = 971;F.filename = "os.nim";
Inquote_35473 = NIM_FALSE;
F.line = 972;F.filename = "os.nim";
while (1) {
F.line = 973;F.filename = "os.nim";
if ((NU)(I_35453) > (NU)(C_35434->Sup.len)) raiseIndexError();
switch (((NU8)(C_35434->data[I_35453]))) {
case 0:
F.line = 974;F.filename = "os.nim";
goto LA8;
break;
case 92:
J_35474 = 0;
F.line = 976;F.filename = "os.nim";
J_35474 = I_35453;
F.line = 977;F.filename = "os.nim";
while (1) {
if ((NU)(J_35474) > (NU)(C_35434->Sup.len)) raiseIndexError();
if (!((NU8)(C_35434->data[J_35474]) == (NU8)(92))) goto LA9;
F.line = 977;F.filename = "os.nim";
J_35474 = addInt(J_35474, 1);
} LA9: ;
F.line = 978;F.filename = "os.nim";
if ((NU)(J_35474) > (NU)(C_35434->Sup.len)) raiseIndexError();
if (!((NU8)(C_35434->data[J_35474]) == (NU8)(34))) goto LA11;
K_35498 = 0;
HEX3Atmp_35622 = 0;
F.line = 979;F.filename = "os.nim";
HEX3Atmp_35622 = divInt(subInt(J_35474, I_35453), 2);
Res_35624 = 0;
F.line = 1021;F.filename = "system.nim";
Res_35624 = 1;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_35624 <= HEX3Atmp_35622)) goto LA13;
F.line = 1021;F.filename = "system.nim";
K_35498 = Res_35624;
F.line = 979;F.filename = "os.nim";
A_35454 = addChar(A_35454, 92);
F.line = 1024;F.filename = "system.nim";
Res_35624 = addInt(Res_35624, 1);
} LA13: ;
F.line = 980;F.filename = "os.nim";
if (!(modInt(subInt(J_35474, I_35453), 2) == 0)) goto LA15;
F.line = 981;F.filename = "os.nim";
I_35453 = J_35474;
goto LA14;
LA15: ;
F.line = 983;F.filename = "os.nim";
A_35454 = addChar(A_35454, 34);
F.line = 984;F.filename = "os.nim";
I_35453 = addInt(J_35474, 1);
LA14: ;
goto LA10;
LA11: ;
F.line = 986;F.filename = "os.nim";
if ((NU)(I_35453) > (NU)(C_35434->Sup.len)) raiseIndexError();
A_35454 = addChar(A_35454, C_35434->data[I_35453]);
F.line = 987;F.filename = "os.nim";
I_35453 = addInt(I_35453, 1);
LA10: ;
break;
case 34:
F.line = 989;F.filename = "os.nim";
I_35453 = addInt(I_35453, 1);
F.line = 990;F.filename = "os.nim";
if (!!(Inquote_35473)) goto LA18;
F.line = 990;F.filename = "os.nim";
Inquote_35473 = NIM_TRUE;
goto LA17;
LA18: ;
if ((NU)(I_35453) > (NU)(C_35434->Sup.len)) raiseIndexError();
if (!((NU8)(C_35434->data[I_35453]) == (NU8)(34))) goto LA20;
F.line = 992;F.filename = "os.nim";
if ((NU)(I_35453) > (NU)(C_35434->Sup.len)) raiseIndexError();
A_35454 = addChar(A_35454, C_35434->data[I_35453]);
F.line = 993;F.filename = "os.nim";
I_35453 = addInt(I_35453, 1);
goto LA17;
LA20: ;
F.line = 995;F.filename = "os.nim";
Inquote_35473 = NIM_FALSE;
F.line = 996;F.filename = "os.nim";
goto LA8;
LA17: ;
break;
case 32:
case 9:
F.line = 998;F.filename = "os.nim";
if (!!(Inquote_35473)) goto LA23;
F.line = 998;F.filename = "os.nim";
goto LA8;
LA23: ;
F.line = 999;F.filename = "os.nim";
if ((NU)(I_35453) > (NU)(C_35434->Sup.len)) raiseIndexError();
A_35454 = addChar(A_35454, C_35434->data[I_35453]);
F.line = 1000;F.filename = "os.nim";
I_35453 = addInt(I_35453, 1);
break;
default:
F.line = 1002;F.filename = "os.nim";
if ((NU)(I_35453) > (NU)(C_35434->Sup.len)) raiseIndexError();
A_35454 = addChar(A_35454, C_35434->data[I_35453]);
F.line = 1003;F.filename = "os.nim";
I_35453 = addInt(I_35453, 1);
break;
}
} LA8: ;
F.line = 1018;F.filename = "os.nim";
Result_35436 = (TY4377*) incrSeq(&(Result_35436)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &Result_35436->data[Result_35436->Sup.len-1], copyString(A_35454));
} LA1: ;
framePtr = framePtr->prev;
return Result_35436;
}
static N_INLINE(NI, chckRange)(NI I_4610, NI A_4611, NI B_4612) {
NI Result_5516;
NIM_BOOL LOC2;
Result_5516 = 0;
LOC2 = (A_4611 <= I_4610);
if (!(LOC2)) goto LA3;
LOC2 = (I_4610 <= B_4612);
LA3: ;
if (!LOC2) goto LA4;
Result_5516 = I_4610;
goto BeforeRet;
goto LA1;
LA4: ;
raiseRangeError(((NI64) (I_4610)));
LA1: ;
BeforeRet: ;
return Result_5516;
}
N_NIMCALL(void, nossleep)(NI Milsecs_37206) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "sleep";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 1216;F.filename = "os.nim";
Dl_27666(((NI32)chckRange(Milsecs_37206, ((NI32) (-2147483647 -1)), ((NI32) 2147483647))));
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, HEX2F_33318)(NimStringDesc* Head_33320, NimStringDesc* Tail_33321) {
NimStringDesc* Result_33322;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "/";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33322 = 0;
F.line = 347;F.filename = "os.nim";
F.line = 347;F.filename = "os.nim";
Result_33322 = nosJoinPath(Head_33320, Tail_33321);
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_33322;
}
N_NIMCALL(NimStringDesc*, nosaddFileExt)(NimStringDesc* Filename_33844, NimStringDesc* Ext_33845) {
NimStringDesc* Result_33846;
NI Extpos_33847;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "addFileExt";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33846 = 0;
Extpos_33847 = 0;
F.line = 545;F.filename = "os.nim";
Extpos_33847 = Searchextpos_33478(Filename_33844);
F.line = 546;F.filename = "os.nim";
if (!(Extpos_33847 < 0)) goto LA2;
F.line = 546;F.filename = "os.nim";
LOC4 = 0;
LOC5 = 0;
LOC5 = Normext_33468(Ext_33845);
LOC4 = rawNewString(Filename_33844->Sup.len + LOC5->Sup.len + 0);
appendString(LOC4, Filename_33844);
appendString(LOC4, LOC5);
Result_33846 = LOC4;
goto LA1;
LA2: ;
F.line = 547;F.filename = "os.nim";
Result_33846 = copyString(Filename_33844);
LA1: ;
framePtr = framePtr->prev;
return Result_33846;
}
N_NIMCALL(NimStringDesc*, nosUnixToNativePath)(NimStringDesc* Path_31256) {
NimStringDesc* Result_31257;
NI Start_31258;
NIM_BOOL LOC4;
NI I_31407;
NIM_BOOL LOC10;
NIM_BOOL LOC11;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "UnixToNativePath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_31257 = 0;
Start_31258 = 0;
F.line = 185;F.filename = "os.nim";
if ((NU)(0) > (NU)(Path_31256->Sup.len)) raiseIndexError();
if (!((NU8)(Path_31256->data[0]) == (NU8)(47))) goto LA2;
F.line = 188;F.filename = "os.nim";
Result_31257 = copyString(((NimStringDesc*) &TMP68416));
F.line = 193;F.filename = "os.nim";
Start_31258 = 1;
goto LA1;
LA2: ;
if ((NU)(0) > (NU)(Path_31256->Sup.len)) raiseIndexError();
LOC4 = ((NU8)(Path_31256->data[0]) == (NU8)(46));
if (!(LOC4)) goto LA5;
if ((NU)(1) > (NU)(Path_31256->Sup.len)) raiseIndexError();
LOC4 = ((NU8)(Path_31256->data[1]) == (NU8)(47));
LA5: ;
if (!LOC4) goto LA6;
F.line = 196;F.filename = "os.nim";
Result_31257 = copyString(((NimStringDesc*) &TMP68417));
F.line = 197;F.filename = "os.nim";
Start_31258 = 2;
goto LA1;
LA6: ;
F.line = 199;F.filename = "os.nim";
Result_31257 = copyString(((NimStringDesc*) &TMP40351));
F.line = 200;F.filename = "os.nim";
Start_31258 = 0;
LA1: ;
I_31407 = 0;
F.line = 202;F.filename = "os.nim";
I_31407 = Start_31258;
F.line = 203;F.filename = "os.nim";
while (1) {
if (!(I_31407 < Path_31256->Sup.len)) goto LA8;
F.line = 204;F.filename = "os.nim";
if ((NU)(I_31407) > (NU)(Path_31256->Sup.len)) raiseIndexError();
LOC11 = ((NU8)(Path_31256->data[I_31407]) == (NU8)(46));
if (!(LOC11)) goto LA12;
if ((NU)(addInt(I_31407, 1)) > (NU)(Path_31256->Sup.len)) raiseIndexError();
LOC11 = ((NU8)(Path_31256->data[addInt(I_31407, 1)]) == (NU8)(46));
LA12: ;
LOC10 = LOC11;
if (!(LOC10)) goto LA13;
if ((NU)(addInt(I_31407, 2)) > (NU)(Path_31256->Sup.len)) raiseIndexError();
LOC10 = ((NU8)(Path_31256->data[addInt(I_31407, 2)]) == (NU8)(47));
LA13: ;
if (!LOC10) goto LA14;
F.line = 212;F.filename = "os.nim";
Result_31257 = resizeString(Result_31257, 3);
appendString(Result_31257, ((NimStringDesc*) &TMP68418));
F.line = 213;F.filename = "os.nim";
I_31407 = addInt(I_31407, 3);
goto LA9;
LA14: ;
if ((NU)(I_31407) > (NU)(Path_31256->Sup.len)) raiseIndexError();
if (!((NU8)(Path_31256->data[I_31407]) == (NU8)(47))) goto LA16;
F.line = 215;F.filename = "os.nim";
Result_31257 = addChar(Result_31257, 92);
F.line = 216;F.filename = "os.nim";
I_31407 = addInt(I_31407, 1);
goto LA9;
LA16: ;
F.line = 218;F.filename = "os.nim";
if ((NU)(I_31407) > (NU)(Path_31256->Sup.len)) raiseIndexError();
Result_31257 = addChar(Result_31257, Path_31256->data[I_31407]);
F.line = 219;F.filename = "os.nim";
I_31407 = addInt(I_31407, 1);
LA9: ;
} LA8: ;
framePtr = framePtr->prev;
return Result_31257;
}
N_NIMCALL(void, Putenv_34439)(NimStringDesc* Key_34441, NimStringDesc* Val_34442) {
NI Indx_34443;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
NI32 LOC7;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "putEnv";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Indx_34443 = 0;
F.line = 754;F.filename = "os.nim";
Indx_34443 = Findenvvar_34402(Key_34441);
F.line = 755;F.filename = "os.nim";
if (!(0 <= Indx_34443)) goto LA2;
F.line = 756;F.filename = "os.nim";
if ((NU)(Indx_34443) >= (NU)(Environment_34238->Sup.len)) raiseIndexError();
LOC4 = 0;
LOC4 = rawNewString(Key_34441->Sup.len + Val_34442->Sup.len + 1);
appendString(LOC4, Key_34441);
appendChar(LOC4, 61);
appendString(LOC4, Val_34442);
asgnRefNoCycle((void**) &Environment_34238->data[Indx_34443], LOC4);
goto LA1;
LA2: ;
F.line = 758;F.filename = "os.nim";
LOC5 = 0;
LOC5 = rawNewString(Key_34441->Sup.len + Val_34442->Sup.len + 1);
appendString(LOC5, Key_34441);
appendChar(LOC5, 61);
appendString(LOC5, Val_34442);
Environment_34238 = (TY4377*) incrSeq(&(Environment_34238)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &Environment_34238->data[Environment_34238->Sup.len-1], copyString(LOC5));
F.line = 759;F.filename = "os.nim";
Indx_34443 = (Environment_34238->Sup.len-1);
LA1: ;
F.line = 764;F.filename = "os.nim";
LOC7 = Dl_27578(Key_34441->data, Val_34442->data);
if (!(LOC7 == ((NI32) 0))) goto LA8;
F.line = 765;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP40351));
LA8: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nosgetConfigDir)(void) {
NimStringDesc* Result_36203;
NimStringDesc* LOC1;
NimStringDesc* LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getConfigDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_36203 = 0;
F.line = 1116;F.filename = "os.nim";
F.line = 1116;F.filename = "os.nim";
LOC1 = 0;
LOC2 = 0;
LOC2 = Getenv_34425(((NimStringDesc*) &TMP75535));
LOC1 = rawNewString(LOC2->Sup.len + 1);
appendString(LOC1, LOC2);
appendString(LOC1, ((NimStringDesc*) &TMP75536));
Result_36203 = LOC1;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_36203;
}
static N_INLINE(NIM_BOOL, eqStrings)(NimStringDesc* A_17247, NimStringDesc* B_17248) {
NIM_BOOL Result_17249;
NIM_BOOL LOC5;
NIM_BOOL LOC9;
NI32 LOC11;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "eqStrings";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_17249 = 0;
F.line = 32;F.filename = "sysstr.nim";
if (!(A_17247 == B_17248)) goto LA2;
F.line = 32;F.filename = "sysstr.nim";
F.line = 32;F.filename = "sysstr.nim";
Result_17249 = NIM_TRUE;
goto BeforeRet;
LA2: ;
F.line = 33;F.filename = "sysstr.nim";
LOC5 = (A_17247 == NIM_NIL);
if (LOC5) goto LA6;
LOC5 = (B_17248 == NIM_NIL);
LA6: ;
if (!LOC5) goto LA7;
F.line = 33;F.filename = "sysstr.nim";
F.line = 33;F.filename = "sysstr.nim";
Result_17249 = NIM_FALSE;
goto BeforeRet;
LA7: ;
F.line = 34;F.filename = "sysstr.nim";
F.line = 34;F.filename = "sysstr.nim";
LOC9 = ((*A_17247).Sup.len == (*B_17248).Sup.len);
if (!(LOC9)) goto LA10;
LOC11 = memcmp(((NCSTRING) ((*A_17247).data)), ((NCSTRING) ((*B_17248).data)), ((NI32) ((NI64)((*A_17247).Sup.len * 1))));
LOC9 = (LOC11 == ((NI32) 0));
LA10: ;
Result_17249 = LOC9;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_17249;
}
N_NIMCALL(NI, noscmpPaths)(NimStringDesc* Patha_33865, NimStringDesc* Pathb_33866) {
NI Result_33867;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "cmpPaths";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33867 = 0;
F.line = 564;F.filename = "os.nim";
if (!NIM_FALSE) goto LA2;
F.line = 565;F.filename = "os.nim";
Result_33867 = Cmp_1321(Patha_33865, Pathb_33866);
goto LA1;
LA2: ;
F.line = 567;F.filename = "os.nim";
Result_33867 = nsuCmpIgnoreCase(Patha_33865, Pathb_33866);
LA1: ;
framePtr = framePtr->prev;
return Result_33867;
}
N_NIMCALL(NIM_BOOL, nossameFile)(NimStringDesc* Path1_33870, NimStringDesc* Path2_33871) {
NIM_BOOL Result_33872;
TY27598 A_33873;
TY27598 B_33874;
NI Resa_33876;
NI Resb_33878;
NIM_BOOL LOC2;
NimStringDesc* LOC6;
NimStringDesc* LOC7;
NI LOC8;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "sameFile";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33872 = 0;
memset((void*)&A_33873, 0, sizeof(A_33873));
memset((void*)&B_33874, 0, sizeof(B_33874));
Resa_33876 = 0;
F.line = 576;F.filename = "os.nim";
Resa_33876 = Dl_27615(Path1_33870->data, &A_33873);
Resb_33878 = 0;
F.line = 577;F.filename = "os.nim";
Resb_33878 = Dl_27615(Path2_33871->data, &B_33874);
F.line = 578;F.filename = "os.nim";
LOC2 = !((Resa_33876 == -1));
if (!(LOC2)) goto LA3;
LOC2 = !((Resb_33878 == -1));
LA3: ;
if (!LOC2) goto LA4;
F.line = 579;F.filename = "os.nim";
LOC6 = 0;
LOC6 = cstrToNimstr(((NCSTRING) (A_33873.Cfilename)));
LOC7 = 0;
LOC7 = cstrToNimstr(((NCSTRING) (B_33874.Cfilename)));
Result_33872 = eqStrings(LOC6, LOC7);
goto LA1;
LA4: ;
F.line = 582;F.filename = "os.nim";
LOC8 = noscmpPaths(Path1_33870, Path2_33871);
Result_33872 = (LOC8 == 0);
LA1: ;
F.line = 583;F.filename = "os.nim";
if (!!((Resa_33876 == -1))) goto LA10;
F.line = 583;F.filename = "os.nim";
Dl_27625(Resa_33876);
LA10: ;
F.line = 584;F.filename = "os.nim";
if (!!((Resb_33878 == -1))) goto LA13;
F.line = 584;F.filename = "os.nim";
Dl_27625(Resb_33878);
LA13: ;
framePtr = framePtr->prev;
return Result_33872;
}
N_NIMCALL(NI32, nosgetLastModificationTime)(NimStringDesc* File_32203) {
NI32 Result_32204;
TY27598 F_32205;
NI H_32207;
NI64 LOC4;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getLastModificationTime";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32204 = 0;
memset((void*)&F_32205, 0, sizeof(F_32205));
H_32207 = 0;
F.line = 250;F.filename = "os.nim";
H_32207 = Dl_27615(File_32203->data, &F_32205);
F.line = 251;F.filename = "os.nim";
if (!(H_32207 == -1)) goto LA2;
F.line = 251;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP40351));
LA2: ;
F.line = 252;F.filename = "os.nim";
LOC4 = Rdfiletime_27654(F_32205.Ftlastwritetime);
Result_32204 = Wintimetounixtime_29261(LOC4);
F.line = 253;F.filename = "os.nim";
Dl_27625(H_32207);
framePtr = framePtr->prev;
return Result_32204;
}
N_NIMCALL(NIM_BOOL, nosfileNewer)(NimStringDesc* A_32803, NimStringDesc* B_32804) {
NIM_BOOL Result_32805;
NI32 LOC1;
NI32 LOC2;
NI64 LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "fileNewer";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32805 = 0;
F.line = 284;F.filename = "os.nim";
LOC1 = nosgetLastModificationTime(A_32803);
LOC2 = nosgetLastModificationTime(B_32804);
LOC3 = ntDiffTime(LOC1, LOC2);
Result_32805 = (0 < LOC3);
framePtr = framePtr->prev;
return Result_32805;
}
N_NIMCALL(NI, nosparamCount)(void) {
NI Result_36405;
NCSTRING LOC4;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "paramCount";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_36405 = 0;
F.line = 1131;F.filename = "os.nim";
if (!Ownargv_36402 == 0) goto LA2;
F.line = 1131;F.filename = "os.nim";
LOC4 = Dl_27652();
LOC5 = 0;
LOC5 = cstrToNimstr(LOC4);
asgnRefNoCycle((void**) &Ownargv_36402, nosparseCmdLine(LOC5));
LA2: ;
F.line = 1132;F.filename = "os.nim";
Result_36405 = subInt(Ownargv_36402->Sup.len, 1);
framePtr = framePtr->prev;
return Result_36405;
}
N_NIMCALL(NimStringDesc*, nosparamStr)(NI I_36426) {
NimStringDesc* Result_36427;
NCSTRING LOC4;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "paramStr";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_36427 = 0;
F.line = 1140;F.filename = "os.nim";
if (!Ownargv_36402 == 0) goto LA2;
F.line = 1140;F.filename = "os.nim";
LOC4 = Dl_27652();
LOC5 = 0;
LOC5 = cstrToNimstr(LOC4);
asgnRefNoCycle((void**) &Ownargv_36402, nosparseCmdLine(LOC5));
LA2: ;
F.line = 1141;F.filename = "os.nim";
F.line = 1141;F.filename = "os.nim";
if ((NU)(I_36426) >= (NU)(Ownargv_36402->Sup.len)) raiseIndexError();
Result_36427 = copyString(Ownargv_36402->data[I_36426]);
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_36427;
}
N_NOINLINE(void, osInit)(void) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "os";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 682;F.filename = "os.nim";
Envcomputed_34220 = NIM_FALSE;
F.line = 683;F.filename = "os.nim";
asgnRefNoCycle((void**) &Environment_34238, (TY4377*) newSeq(NTI4377, 0));
framePtr = framePtr->prev;
}

