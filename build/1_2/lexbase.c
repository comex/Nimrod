/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct TY71015 TY71015;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY70013 TY70013;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef NU8 TY21402[32];
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY71015 {
  TNimObject Sup;
NI Bufpos;
NCSTRING Buf;
NI Buflen;
TY70013* Stream;
NI Linenumber;
NI Sentinel;
NI Linestart;
};
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY70013 {
  TNimObject Sup;
NU8 Kind;
FILE* F;
NimStringDesc* S;
NI Rd;
NI Wr;
};
N_NIMCALL(void, Closebaselexer_71029)(TY71015* L_71032);
N_NOCONV(void, Dealloc_1960)(void* P_1962);
N_NIMCALL(void, Llstreamclose_70040)(TY70013* S_70042);
N_NIMCALL(void, Fillbuffer_71056)(TY71015* L_71059);
N_NIMCALL(void, internalAssert)(NCSTRING File_5254, NI Line_5255, NIM_BOOL Cond_5256);
static N_INLINE(NI, subInt)(NI A_6003, NI B_6004);
N_NOINLINE(void, raiseOverflow)(void);
static N_INLINE(NI, addInt)(NI A_5803, NI B_5804);
N_NIMCALL(NI, mulInt)(NI A_6803, NI B_6804);
N_NIMCALL(NI, Llstreamread_70043)(TY70013* S_70045, void* Buf_70046, NI Buflen_70047);
static N_INLINE(NI, divInt)(NI A_6403, NI B_6404);
N_NOINLINE(void, raiseDivByZero)(void);
N_NOCONV(void*, Realloc_1956)(void* P_1958, NI Newsize_1959);
N_NIMCALL(NI, Fillbaselexer_71122)(TY71015* L_71125, NI Pos_71126);
N_NIMCALL(NI, Handlecr_71041)(TY71015* L_71044, NI Pos_71045);
N_NIMCALL(NI, Handlelf_71046)(TY71015* L_71049, NI Pos_71050);
N_NIMCALL(void, Skiputf8bom_71174)(TY71015* L_71177);
N_NIMCALL(void, Openbaselexer_71023)(TY71015* L_71026, TY70013* Inputstream_71027, NI Buflen_71028);
N_NOCONV(void*, Alloc_1950)(NI Size_1952);
N_NIMCALL(void, unsureAsgnRef)(void** Dest_11826, void* Src_11827);
N_NIMCALL(NI, Getcolnumber_71037)(TY71015* L_71039, NI Pos_71040);
N_NIMCALL(NimStringDesc*, Getcurrentline_71033)(TY71015* L_71035, NIM_BOOL Marker_71036);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_17308);
N_NIMCALL(NimStringDesc*, addChar)(NimStringDesc* S_1603, NIM_CHAR C_1604);
static N_INLINE(void, appendString)(NimStringDesc* Dest_17392, NimStringDesc* Src_17393);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_17287);
N_NIMCALL(NimStringDesc*, nsuRepeatChar)(NI Count_24750, NIM_CHAR C_24751);
NIM_CONST TY21402 Newlines_71012 = {
0x00, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
STRING_LITERAL(TMP71280, "", 0);
STRING_LITERAL(TMP71281, "\015\012", 2);
STRING_LITERAL(TMP71282, "^\015\012", 3);
N_NIMCALL(void, Closebaselexer_71029)(TY71015* L_71032) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "closeBaseLexer";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 71;F.filename = "lexbase.nim";
Dealloc_1960(((void*) ((*L_71032).Buf)));
F.line = 72;F.filename = "lexbase.nim";
Llstreamclose_70040((*L_71032).Stream);
framePtr = framePtr->prev;
}
static N_INLINE(NI, subInt)(NI A_6003, NI B_6004) {
NI Result_6005;
NIM_BOOL LOC2;
Result_6005 = 0;
Result_6005 = (NI64)((NU64)(A_6003) - (NU64)(B_6004));
LOC2 = (0 <= (NI64)(Result_6005 ^ A_6003));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_6005 ^ (NI64)((NU64) ~(B_6004))));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_6005;
}
static N_INLINE(NI, addInt)(NI A_5803, NI B_5804) {
NI Result_5805;
NIM_BOOL LOC2;
Result_5805 = 0;
Result_5805 = (NI64)((NU64)(A_5803) + (NU64)(B_5804));
LOC2 = (0 <= (NI64)(Result_5805 ^ A_5803));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5805 ^ B_5804));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5805;
}
static N_INLINE(NI, divInt)(NI A_6403, NI B_6404) {
NI Result_6405;
NIM_BOOL LOC5;
Result_6405 = 0;
if (!(B_6404 == 0)) goto LA2;
raiseDivByZero();
LA2: ;
LOC5 = (A_6403 == (IL64(-9223372036854775807) - IL64(1)));
if (!(LOC5)) goto LA6;
LOC5 = (B_6404 == -1);
LA6: ;
if (!LOC5) goto LA7;
raiseOverflow();
LA7: ;
Result_6405 = (NI64)(A_6403 / B_6404);
goto BeforeRet;
BeforeRet: ;
return Result_6405;
}
N_NIMCALL(void, Fillbuffer_71056)(TY71015* L_71059) {
NI Charsread_71060;
NI Tocopy_71061;
NI S_71062;
NI Oldbuflen_71063;
NI LOC4;
NIM_BOOL LOC10;
void* LOC15;
NI LOC16;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "FillBuffer";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Charsread_71060 = 0;
Tocopy_71061 = 0;
S_71062 = 0;
Oldbuflen_71063 = 0;
F.line = 82;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 82, ((*L_71059).Sentinel < (*L_71059).Buflen));
F.line = 83;F.filename = "lexbase.nim";
Tocopy_71061 = subInt(subInt((*L_71059).Buflen, (*L_71059).Sentinel), 1);
F.line = 84;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 84, (0 <= Tocopy_71061));
F.line = 85;F.filename = "lexbase.nim";
if (!(0 < Tocopy_71061)) goto LA2;
F.line = 86;F.filename = "lexbase.nim";
memmove(((void*) ((*L_71059).Buf)), ((void*) (&(*L_71059).Buf[addInt((*L_71059).Sentinel, 1)])), mulInt(Tocopy_71061, 1));
LA2: ;
F.line = 88;F.filename = "lexbase.nim";
LOC4 = Llstreamread_70043((*L_71059).Stream, ((void*) (&(*L_71059).Buf[Tocopy_71061])), mulInt(addInt((*L_71059).Sentinel, 1), 1));
Charsread_71060 = divInt(LOC4, 1);
F.line = 90;F.filename = "lexbase.nim";
S_71062 = addInt(Tocopy_71061, Charsread_71060);
F.line = 91;F.filename = "lexbase.nim";
if (!(Charsread_71060 < addInt((*L_71059).Sentinel, 1))) goto LA6;
F.line = 92;F.filename = "lexbase.nim";
(*L_71059).Buf[S_71062] = 0;
F.line = 93;F.filename = "lexbase.nim";
(*L_71059).Sentinel = S_71062;
goto LA5;
LA6: ;
F.line = 96;F.filename = "lexbase.nim";
S_71062 = subInt(S_71062, 1);
F.line = 97;F.filename = "lexbase.nim";
while (1) {
F.line = 98;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 98, (S_71062 < (*L_71059).Buflen));
F.line = 99;F.filename = "lexbase.nim";
while (1) {
LOC10 = (0 <= S_71062);
if (!(LOC10)) goto LA11;
LOC10 = !((((NU8)((*L_71059).Buf[S_71062])) == ((NU8)(13)) || ((NU8)((*L_71059).Buf[S_71062])) == ((NU8)(10))));
LA11: ;
if (!LOC10) goto LA9;
F.line = 99;F.filename = "lexbase.nim";
S_71062 = subInt(S_71062, 1);
} LA9: ;
F.line = 100;F.filename = "lexbase.nim";
if (!(0 <= S_71062)) goto LA13;
F.line = 102;F.filename = "lexbase.nim";
(*L_71059).Sentinel = S_71062;
F.line = 103;F.filename = "lexbase.nim";
goto LA8;
goto LA12;
LA13: ;
F.line = 107;F.filename = "lexbase.nim";
Oldbuflen_71063 = (*L_71059).Buflen;
F.line = 108;F.filename = "lexbase.nim";
(*L_71059).Buflen = mulInt((*L_71059).Buflen, 2);
F.line = 109;F.filename = "lexbase.nim";
LOC15 = Realloc_1956(((void*) ((*L_71059).Buf)), mulInt((*L_71059).Buflen, 1));
(*L_71059).Buf = ((NCSTRING) (LOC15));
F.line = 110;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 110, (subInt((*L_71059).Buflen, Oldbuflen_71063) == Oldbuflen_71063));
F.line = 111;F.filename = "lexbase.nim";
LOC16 = Llstreamread_70043((*L_71059).Stream, ((void*) (&(*L_71059).Buf[Oldbuflen_71063])), mulInt(Oldbuflen_71063, 1));
Charsread_71060 = divInt(LOC16, 1);
F.line = 113;F.filename = "lexbase.nim";
if (!(Charsread_71060 < Oldbuflen_71063)) goto LA18;
F.line = 114;F.filename = "lexbase.nim";
(*L_71059).Buf[addInt(Oldbuflen_71063, Charsread_71060)] = 0;
F.line = 115;F.filename = "lexbase.nim";
(*L_71059).Sentinel = addInt(Oldbuflen_71063, Charsread_71060);
F.line = 116;F.filename = "lexbase.nim";
goto LA8;
LA18: ;
F.line = 117;F.filename = "lexbase.nim";
S_71062 = subInt((*L_71059).Buflen, 1);
LA12: ;
} LA8: ;
LA5: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NI, Fillbaselexer_71122)(TY71015* L_71125, NI Pos_71126) {
NI Result_71127;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "fillBaseLexer";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_71127 = 0;
F.line = 120;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 120, (Pos_71126 <= (*L_71125).Sentinel));
F.line = 121;F.filename = "lexbase.nim";
if (!(Pos_71126 < (*L_71125).Sentinel)) goto LA2;
F.line = 122;F.filename = "lexbase.nim";
Result_71127 = addInt(Pos_71126, 1);
goto LA1;
LA2: ;
F.line = 124;F.filename = "lexbase.nim";
Fillbuffer_71056(L_71125);
F.line = 125;F.filename = "lexbase.nim";
(*L_71125).Bufpos = 0;
F.line = 126;F.filename = "lexbase.nim";
Result_71127 = 0;
LA1: ;
F.line = 127;F.filename = "lexbase.nim";
(*L_71125).Linestart = Result_71127;
framePtr = framePtr->prev;
return Result_71127;
}
N_NIMCALL(NI, Handlecr_71041)(TY71015* L_71044, NI Pos_71045) {
NI Result_71137;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "HandleCR";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_71137 = 0;
F.line = 130;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 130, ((NU8)((*L_71044).Buf[Pos_71045]) == (NU8)(13)));
F.line = 131;F.filename = "lexbase.nim";
(*L_71044).Linenumber = addInt((*L_71044).Linenumber, 1);
F.line = 132;F.filename = "lexbase.nim";
Result_71137 = Fillbaselexer_71122(L_71044, Pos_71045);
F.line = 133;F.filename = "lexbase.nim";
if (!((NU8)((*L_71044).Buf[Result_71137]) == (NU8)(10))) goto LA2;
F.line = 134;F.filename = "lexbase.nim";
Result_71137 = Fillbaselexer_71122(L_71044, Result_71137);
LA2: ;
framePtr = framePtr->prev;
return Result_71137;
}
N_NIMCALL(NI, Handlelf_71046)(TY71015* L_71049, NI Pos_71050) {
NI Result_71159;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "HandleLF";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_71159 = 0;
F.line = 137;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 137, ((NU8)((*L_71049).Buf[Pos_71050]) == (NU8)(10)));
F.line = 138;F.filename = "lexbase.nim";
(*L_71049).Linenumber = addInt((*L_71049).Linenumber, 1);
F.line = 139;F.filename = "lexbase.nim";
Result_71159 = Fillbaselexer_71122(L_71049, Pos_71050);
framePtr = framePtr->prev;
return Result_71159;
}
N_NIMCALL(void, Skiputf8bom_71174)(TY71015* L_71177) {
NIM_BOOL LOC2;
NIM_BOOL LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "skip_UTF_8_BOM";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 142;F.filename = "lexbase.nim";
LOC3 = ((NU8)((*L_71177).Buf[0]) == (NU8)(239));
if (!(LOC3)) goto LA4;
LOC3 = ((NU8)((*L_71177).Buf[1]) == (NU8)(187));
LA4: ;
LOC2 = LOC3;
if (!(LOC2)) goto LA5;
LOC2 = ((NU8)((*L_71177).Buf[2]) == (NU8)(191));
LA5: ;
if (!LOC2) goto LA6;
F.line = 143;F.filename = "lexbase.nim";
(*L_71177).Bufpos = addInt((*L_71177).Bufpos, 3);
F.line = 144;F.filename = "lexbase.nim";
(*L_71177).Linestart = addInt((*L_71177).Linestart, 3);
LA6: ;
framePtr = framePtr->prev;
}
N_NIMCALL(void, Openbaselexer_71023)(TY71015* L_71026, TY70013* Inputstream_71027, NI Buflen_71028) {
void* LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "openBaseLexer";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 147;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 147, (0 < Buflen_71028));
F.line = 148;F.filename = "lexbase.nim";
(*L_71026).Bufpos = 0;
F.line = 149;F.filename = "lexbase.nim";
(*L_71026).Buflen = Buflen_71028;
F.line = 150;F.filename = "lexbase.nim";
LOC1 = Alloc_1950(mulInt(Buflen_71028, 1));
(*L_71026).Buf = ((NCSTRING) (LOC1));
F.line = 151;F.filename = "lexbase.nim";
(*L_71026).Sentinel = subInt(Buflen_71028, 1);
F.line = 152;F.filename = "lexbase.nim";
(*L_71026).Linestart = 0;
F.line = 153;F.filename = "lexbase.nim";
(*L_71026).Linenumber = 1;
F.line = 154;F.filename = "lexbase.nim";
unsureAsgnRef((void**) &(*L_71026).Stream, Inputstream_71027);
F.line = 155;F.filename = "lexbase.nim";
Fillbuffer_71056(L_71026);
F.line = 156;F.filename = "lexbase.nim";
Skiputf8bom_71174(L_71026);
framePtr = framePtr->prev;
}
N_NIMCALL(NI, Getcolnumber_71037)(TY71015* L_71039, NI Pos_71040) {
NI Result_71220;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getColNumber";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_71220 = 0;
F.line = 159;F.filename = "lexbase.nim";
if (subInt(Pos_71040, (*L_71039).Linestart) == (IL64(-9223372036854775807) - IL64(1))) raiseOverflow();
Result_71220 = (NI64)abs(subInt(Pos_71040, (*L_71039).Linestart));
framePtr = framePtr->prev;
return Result_71220;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_17392, NimStringDesc* Src_17393) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendString";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 150;F.filename = "sysstr.nim";
memcpy(((NCSTRING) (&(*Dest_17392).data[((*Dest_17392).Sup.len)-0])), ((NCSTRING) ((*Src_17393).data)), ((NI32) ((NI64)((NI64)((*Src_17393).Sup.len + 1) * 1))));
F.line = 151;F.filename = "sysstr.nim";
(*Dest_17392).Sup.len += (*Src_17393).Sup.len;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, Getcurrentline_71033)(TY71015* L_71035, NIM_BOOL Marker_71036) {
NimStringDesc* Result_71225;
NI I_71226;
NimStringDesc* LOC2;
NimStringDesc* LOC6;
NI LOC7;
NimStringDesc* LOC8;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getCurrentLine";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_71225 = 0;
F.line = 162;F.filename = "lexbase.nim";
Result_71225 = copyString(((NimStringDesc*) &TMP71280));
I_71226 = 0;
F.line = 163;F.filename = "lexbase.nim";
I_71226 = (*L_71035).Linestart;
F.line = 164;F.filename = "lexbase.nim";
while (1) {
if (!!((((NU8)((*L_71035).Buf[I_71226])) == ((NU8)(13)) || ((NU8)((*L_71035).Buf[I_71226])) == ((NU8)(10)) || ((NU8)((*L_71035).Buf[I_71226])) == ((NU8)(0))))) goto LA1;
F.line = 165;F.filename = "lexbase.nim";
Result_71225 = addChar(Result_71225, (*L_71035).Buf[I_71226]);
F.line = 166;F.filename = "lexbase.nim";
I_71226 = addInt(I_71226, 1);
} LA1: ;
F.line = 167;F.filename = "lexbase.nim";
LOC2 = 0;
LOC2 = rawNewString(Result_71225->Sup.len + 2);
appendString(LOC2, Result_71225);
appendString(LOC2, ((NimStringDesc*) &TMP71281));
Result_71225 = LOC2;
F.line = 168;F.filename = "lexbase.nim";
if (!Marker_71036) goto LA4;
F.line = 169;F.filename = "lexbase.nim";
LOC6 = 0;
LOC7 = Getcolnumber_71037(L_71035, (*L_71035).Bufpos);
LOC8 = 0;
LOC8 = nsuRepeatChar(LOC7, 32);
LOC6 = rawNewString(Result_71225->Sup.len + LOC8->Sup.len + 3);
appendString(LOC6, Result_71225);
appendString(LOC6, LOC8);
appendString(LOC6, ((NimStringDesc*) &TMP71282));
Result_71225 = LOC6;
LA4: ;
framePtr = framePtr->prev;
return Result_71225;
}
N_NOINLINE(void, lexbaseInit)(void) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "lexbase";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
framePtr = framePtr->prev;
}

