/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

#include <errno.h>
#include <pthread.h>
#include <unistd.h>
#include <string.h>
#include <sys/stat.h>
#include <time.h>
typedef struct TY4377 TY4377;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY10802 TY10802;
typedef struct TY11190 TY11190;
typedef struct TY10818 TY10818;
typedef struct TY10814 TY10814;
typedef struct TY10810 TY10810;
typedef struct TY11188 TY11188;
typedef struct TY37578 TY37578;
typedef struct TY37715 TY37715;
typedef struct TY422 TY422;
typedef struct TY418 TY418;
typedef struct TY416 TY416;
typedef struct E_Base E_Base;
typedef struct TNimObject TNimObject;
typedef struct TY444 TY444;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY10802 {
NI Refcount;
TNimType* Typ;
};
struct TY10818 {
NI Len;
NI Cap;
TY10802** D;
};
struct TY10814 {
NI Counter;
NI Max;
TY10810* Head;
TY10810** Data;
};
struct TY11188 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY11190 {
TY10818 Zct;
TY10818 Decstack;
TY10814 Cycleroots;
TY10818 Tempstack;
NI Cyclerootslock;
NI Zctlock;
TY11188 Stat;
};
struct TY37578 {
NimStringDesc* Head;
NimStringDesc* Tail;
};
struct TY37715 {
NimStringDesc* Dir;
NimStringDesc* Name;
NimStringDesc* Ext;
};
struct TNimObject {
TNimType* m_type;
};
struct E_Base {
  TNimObject Sup;
E_Base* parent;
NCSTRING name;
NimStringDesc* message;
};
struct TY416 {
  E_Base Sup;
};
struct TY418 {
  TY416 Sup;
};
struct TY422 {
  TY418 Sup;
};
struct TY444 {
  TY416 Sup;
};
typedef NI TY8814[8];
struct TY10810 {
TY10810* Next;
NI Key;
TY8814 Bits;
};
struct TY4377 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
N_NIMCALL(void*, newSeq)(TNimType* Typ_13004, NI Len_13005);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_12018, void* Src_12019);
static N_INLINE(TY10802*, Usrtocell_11236)(void* Usr_11238);
static N_INLINE(NI, Atomicinc_3001)(NI* Memloc_3004, NI X_3005);
static N_INLINE(NI, Atomicdec_3006)(NI* Memloc_3009, NI X_3010);
static N_INLINE(void, Rtladdzct_11858)(TY10802* C_11860);
N_NOINLINE(void, Addzct_11225)(TY10818* S_11228, TY10802* C_11229);
N_NIMCALL(NI, Findenvvar_38602)(NimStringDesc* Key_38604);
N_NIMCALL(void, Getenvvarsc_38441)(void);
N_NOINLINE(void, raiseIndexError)(void);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING Str_17504);
N_NIMCALL(TGenericSeq*, incrSeq)(TGenericSeq* Seq_17635, NI Elemsize_17636);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_17508);
static N_INLINE(NI, addInt)(NI A_5803, NI B_5804);
N_NOINLINE(void, raiseOverflow)(void);
static N_INLINE(void, appendString)(NimStringDesc* Dest_17592, NimStringDesc* Src_17593);
static N_INLINE(void, appendChar)(NimStringDesc* Dest_17609, NIM_CHAR C_17610);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_17487);
N_NIMCALL(NIM_BOOL, nsuStartsWith)(NimStringDesc* S_24769, NimStringDesc* Prefix_24770);
N_NIMCALL(NimStringDesc*, copyStr)(NimStringDesc* S_1924, NI First_1925);
N_NIMCALL(NI, nsuFindChar)(NimStringDesc* S_25227, NIM_CHAR Sub_25228, NI Start_25229);
N_NIMCALL(NI, Searchextpos_37678)(NimStringDesc* S_37680);
static N_INLINE(NI, subInt)(NI A_6003, NI B_6004);
N_NIMCALL(NimStringDesc*, Normext_37668)(NimStringDesc* Ext_37670);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* S_1928, NI First_1929, NI Last_1930);
N_NIMCALL(void, unsureAsgnRef)(void** Dest_12026, void* Src_12027);
N_NIMCALL(void, nossplitFile)(NimStringDesc* Path_37714, TY37715* Result);
N_NIMCALL(NimStringDesc*, nosgetApplicationFilename)(void);
N_NIMCALL(NimStringDesc*, Getapplaux_40801)(NimStringDesc* Procpath_40803);
N_NIMCALL(NimStringDesc*, mnewString)(NI Len_1349);
N_NIMCALL(NimStringDesc*, setLengthStr)(NimStringDesc* S_17625, NI Newlen_17626);
N_NOINLINE(void, nosOSError)(NimStringDesc* Msg_35604);
N_NIMCALL(void*, newObj)(TNimType* Typ_12507, NI Size_12508);
N_NIMCALL(void, raiseException)(E_Base* E_5204, NCSTRING Ename_5205);
N_NIMCALL(NimStringDesc*, nosJoinPath)(NimStringDesc* Head_37403, NimStringDesc* Tail_37404);
N_NIMCALL(void, Rawcreatedir_39423)(NimStringDesc* Dir_39425);
N_NIMCALL(void, nosSplitPath)(NimStringDesc* Path_37577, TY37578* Result);
N_NIMCALL(NimStringDesc*, addChar)(NimStringDesc* S_1603, NIM_CHAR C_1604);
static N_INLINE(NI, divInt)(NI A_6403, NI B_6404);
N_NOINLINE(void, raiseDivByZero)(void);
static N_INLINE(NI, modInt)(NI A_6603, NI B_6604);
N_NIMCALL(NI, mulInt)(NI A_6803, NI B_6804);
N_NIMCALL(NimStringDesc*, Getenv_38625)(NimStringDesc* Key_38627);
N_NIMCALL(NI, noscmpPaths)(NimStringDesc* Patha_38065, NimStringDesc* Pathb_38066);
N_NIMCALL(NI, Cmp_1321)(NimStringDesc* X_1323, NimStringDesc* Y_1324);
N_NIMCALL(NI, nsuCmpIgnoreCase)(NimStringDesc* A_23595, NimStringDesc* B_23596);
N_NIMCALL(NI64, ntDiffTime)(NI A_27635, NI B_27636);
N_NIMCALL(NI, nosgetLastModificationTime)(NimStringDesc* File_36403);
STRING_LITERAL(TMP44351, "", 0);
STRING_LITERAL(TMP45197, "/proc/self/exe", 14);
STRING_LITERAL(TMP45221, "unknown OS error", 16);
STRING_LITERAL(TMP78535, "HOME", 4);
STRING_LITERAL(TMP78536, "/.config/", 9);
STRING_LITERAL(TMP194612, "invalid index", 13);
NIM_BOOL Envcomputed_38421;
TY4377* Environment_38439;
extern TNimType* NTI4377; /* seq[string] */
extern TY11190 Gch_11210;
extern NCSTRING* environ;
extern int cmdCount;
extern NCSTRING* cmdLine;
extern TNimType* NTI35803; /* ref EOS */
extern TNimType* NTI422; /* EOS */
extern TNimType* NTI5456; /* ref EInvalidIndex */
extern TNimType* NTI444; /* EInvalidIndex */
static N_INLINE(TY10802*, Usrtocell_11236)(void* Usr_11238) {
TY10802* Result_11239;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "usrToCell";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_11239 = 0;
F.line = 100;F.filename = "gc.nim";
Result_11239 = ((TY10802*) ((NI64)((NU64)(((NI) (Usr_11238))) - (NU64)(((NI) (((NI)sizeof(TY10802))))))));
framePtr = framePtr->prev;
return Result_11239;
}
static N_INLINE(NI, Atomicinc_3001)(NI* Memloc_3004, NI X_3005) {
NI Result_7408;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicInc";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7408 = 0;
F.line = 29;F.filename = "systhread.nim";
Result_7408 = __sync_add_and_fetch(Memloc_3004, X_3005);
framePtr = framePtr->prev;
return Result_7408;
}
static N_INLINE(NI, Atomicdec_3006)(NI* Memloc_3009, NI X_3010) {
NI Result_7606;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicDec";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7606 = 0;
F.line = 37;F.filename = "systhread.nim";
Result_7606 = __sync_sub_and_fetch(Memloc_3009, X_3010);
framePtr = framePtr->prev;
return Result_7606;
}
static N_INLINE(void, Rtladdzct_11858)(TY10802* C_11860) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "rtlAddZCT";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 211;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA2;
F.line = 211;F.filename = "gc.nim";
pthread_mutex_lock(&Gch_11210.Zctlock);
LA2: ;
F.line = 212;F.filename = "gc.nim";
Addzct_11225(&Gch_11210.Zct, C_11860);
F.line = 213;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA5;
F.line = 213;F.filename = "gc.nim";
pthread_mutex_unlock(&Gch_11210.Zctlock);
LA5: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_12018, void* Src_12019) {
TY10802* C_12020;
NI LOC4;
TY10802* C_12022;
NI LOC9;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "asgnRefNoCycle";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 244;F.filename = "gc.nim";
if (!!((Src_12019 == NIM_NIL))) goto LA2;
C_12020 = 0;
F.line = 245;F.filename = "gc.nim";
C_12020 = Usrtocell_11236(Src_12019);
F.line = 246;F.filename = "gc.nim";
LOC4 = Atomicinc_3001(&(*C_12020).Refcount, 8);
LA2: ;
F.line = 247;F.filename = "gc.nim";
if (!!(((*Dest_12018) == NIM_NIL))) goto LA6;
C_12022 = 0;
F.line = 248;F.filename = "gc.nim";
C_12022 = Usrtocell_11236((*Dest_12018));
F.line = 249;F.filename = "gc.nim";
LOC9 = Atomicdec_3006(&(*C_12022).Refcount, 8);
if (!((NU64)(LOC9) < (NU64)(8))) goto LA10;
F.line = 250;F.filename = "gc.nim";
Rtladdzct_11858(C_12022);
LA10: ;
LA6: ;
F.line = 251;F.filename = "gc.nim";
(*Dest_12018) = Src_12019;
framePtr = framePtr->prev;
}
static N_INLINE(NI, addInt)(NI A_5803, NI B_5804) {
NI Result_5805;
NIM_BOOL LOC2;
Result_5805 = 0;
Result_5805 = (NI64)((NU64)(A_5803) + (NU64)(B_5804));
LOC2 = (0 <= (NI64)(Result_5805 ^ A_5803));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5805 ^ B_5804));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5805;
}
N_NIMCALL(void, Getenvvarsc_38441)(void) {
NI I_38443;
NimStringDesc* LOC8;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getEnvVarsC";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 711;F.filename = "os.nim";
if (!!(Envcomputed_38421)) goto LA2;
I_38443 = 0;
F.line = 712;F.filename = "os.nim";
I_38443 = 0;
F.line = 713;F.filename = "os.nim";
while (1) {
F.line = 714;F.filename = "os.nim";
if ((NU)(I_38443) > (NU)(50000)) raiseIndexError();
if (!(environ[(I_38443)-0] == NIM_NIL)) goto LA6;
F.line = 714;F.filename = "os.nim";
goto LA4;
LA6: ;
F.line = 715;F.filename = "os.nim";
if ((NU)(I_38443) > (NU)(50000)) raiseIndexError();
LOC8 = 0;
LOC8 = cstrToNimstr(environ[(I_38443)-0]);
Environment_38439 = (TY4377*) incrSeq(&(Environment_38439)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &Environment_38439->data[Environment_38439->Sup.len-1], copyString(LOC8));
F.line = 716;F.filename = "os.nim";
I_38443 = addInt(I_38443, 1);
} LA4: ;
F.line = 717;F.filename = "os.nim";
Envcomputed_38421 = NIM_TRUE;
LA2: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_17592, NimStringDesc* Src_17593) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendString";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 150;F.filename = "sysstr.nim";
memcpy(((NCSTRING) (&(*Dest_17592).data[((*Dest_17592).Sup.len)-0])), ((NCSTRING) ((*Src_17593).data)), ((int) ((NI64)((NI64)((*Src_17593).Sup.len + 1) * 1))));
F.line = 151;F.filename = "sysstr.nim";
(*Dest_17592).Sup.len += (*Src_17593).Sup.len;
framePtr = framePtr->prev;
}
static N_INLINE(void, appendChar)(NimStringDesc* Dest_17609, NIM_CHAR C_17610) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendChar";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 154;F.filename = "sysstr.nim";
(*Dest_17609).data[((*Dest_17609).Sup.len)-0] = C_17610;
F.line = 155;F.filename = "sysstr.nim";
(*Dest_17609).data[((NI64)((*Dest_17609).Sup.len + 1))-0] = 0;
F.line = 156;F.filename = "sysstr.nim";
(*Dest_17609).Sup.len += 1;
framePtr = framePtr->prev;
}
N_NIMCALL(NI, Findenvvar_38602)(NimStringDesc* Key_38604) {
NI Result_38605;
NimStringDesc* Temp_38610;
NimStringDesc* LOC1;
NI I_38618;
NI HEX3Atmp_38620;
NI Res_38622;
NIM_BOOL LOC4;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "findEnvVar";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_38605 = 0;
F.line = 720;F.filename = "os.nim";
Getenvvarsc_38441();
Temp_38610 = 0;
F.line = 721;F.filename = "os.nim";
LOC1 = 0;
LOC1 = rawNewString(Key_38604->Sup.len + 1);
appendString(LOC1, Key_38604);
appendChar(LOC1, 61);
Temp_38610 = LOC1;
I_38618 = 0;
HEX3Atmp_38620 = 0;
F.line = 722;F.filename = "os.nim";
HEX3Atmp_38620 = (Environment_38439->Sup.len-1);
Res_38622 = 0;
F.line = 1021;F.filename = "system.nim";
Res_38622 = 0;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_38622 <= HEX3Atmp_38620)) goto LA2;
F.line = 1021;F.filename = "system.nim";
I_38618 = Res_38622;
F.line = 723;F.filename = "os.nim";
if ((NU)(I_38618) >= (NU)(Environment_38439->Sup.len)) raiseIndexError();
LOC4 = nsuStartsWith(Environment_38439->data[I_38618], Temp_38610);
if (!LOC4) goto LA5;
F.line = 723;F.filename = "os.nim";
F.line = 723;F.filename = "os.nim";
Result_38605 = I_38618;
goto BeforeRet;
LA5: ;
F.line = 1024;F.filename = "system.nim";
Res_38622 = addInt(Res_38622, 1);
} LA2: ;
F.line = 724;F.filename = "os.nim";
F.line = 724;F.filename = "os.nim";
Result_38605 = -1;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_38605;
}
N_NIMCALL(NimStringDesc*, Getenv_38625)(NimStringDesc* Key_38627) {
NimStringDesc* Result_38628;
NI I_38629;
NI LOC4;
NCSTRING Env_38632;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getEnv";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_38628 = 0;
I_38629 = 0;
F.line = 732;F.filename = "os.nim";
I_38629 = Findenvvar_38602(Key_38627);
F.line = 733;F.filename = "os.nim";
if (!(0 <= I_38629)) goto LA2;
F.line = 734;F.filename = "os.nim";
F.line = 734;F.filename = "os.nim";
if ((NU)(I_38629) >= (NU)(Environment_38439->Sup.len)) raiseIndexError();
if ((NU)(I_38629) >= (NU)(Environment_38439->Sup.len)) raiseIndexError();
LOC4 = nsuFindChar(Environment_38439->data[I_38629], 61, 0);
Result_38628 = copyStr(Environment_38439->data[I_38629], addInt(LOC4, 1));
goto BeforeRet;
goto LA1;
LA2: ;
Env_38632 = 0;
F.line = 736;F.filename = "os.nim";
Env_38632 = getenv(Key_38627->data);
F.line = 737;F.filename = "os.nim";
if (!(Env_38632 == NIM_NIL)) goto LA6;
F.line = 737;F.filename = "os.nim";
F.line = 737;F.filename = "os.nim";
Result_38628 = copyString(((NimStringDesc*) &TMP44351));
goto BeforeRet;
LA6: ;
F.line = 738;F.filename = "os.nim";
Result_38628 = cstrToNimstr(Env_38632);
LA1: ;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_38628;
}
static N_INLINE(NI, subInt)(NI A_6003, NI B_6004) {
NI Result_6005;
NIM_BOOL LOC2;
Result_6005 = 0;
Result_6005 = (NI64)((NU64)(A_6003) - (NU64)(B_6004));
LOC2 = (0 <= (NI64)(Result_6005 ^ A_6003));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_6005 ^ (NI64)((NU64) ~(B_6004))));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_6005;
}
N_NIMCALL(NI, Searchextpos_37678)(NimStringDesc* S_37680) {
NI Result_37681;
NI I_37691;
NI HEX3Atmp_37707;
NI Res_37709;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "searchExtPos";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37681 = 0;
F.line = 424;F.filename = "os.nim";
Result_37681 = -1;
I_37691 = 0;
HEX3Atmp_37707 = 0;
F.line = 425;F.filename = "os.nim";
HEX3Atmp_37707 = subInt(S_37680->Sup.len, 1);
Res_37709 = 0;
F.line = 1012;F.filename = "system.nim";
Res_37709 = HEX3Atmp_37707;
F.line = 1013;F.filename = "system.nim";
while (1) {
if (!(1 <= Res_37709)) goto LA1;
F.line = 1012;F.filename = "system.nim";
I_37691 = Res_37709;
F.line = 426;F.filename = "os.nim";
if ((NU)(I_37691) > (NU)(S_37680->Sup.len)) raiseIndexError();
if (!((NU8)(S_37680->data[I_37691]) == (NU8)(46))) goto LA3;
F.line = 427;F.filename = "os.nim";
Result_37681 = I_37691;
F.line = 428;F.filename = "os.nim";
goto LA1;
goto LA2;
LA3: ;
if ((NU)(I_37691) > (NU)(S_37680->Sup.len)) raiseIndexError();
if (!(((NU8)(S_37680->data[I_37691])) == ((NU8)(47)) || ((NU8)(S_37680->data[I_37691])) == ((NU8)(47)))) goto LA5;
F.line = 430;F.filename = "os.nim";
goto LA1;
goto LA2;
LA5: ;
LA2: ;
F.line = 1015;F.filename = "system.nim";
Res_37709 = subInt(Res_37709, 1);
} LA1: ;
framePtr = framePtr->prev;
return Result_37681;
}
N_NIMCALL(NimStringDesc*, Normext_37668)(NimStringDesc* Ext_37670) {
NimStringDesc* Result_37671;
NIM_BOOL LOC2;
NimStringDesc* LOC6;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "normExt";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37671 = 0;
F.line = 419;F.filename = "os.nim";
LOC2 = ((Ext_37670) && (Ext_37670)->Sup.len == 0);
if (LOC2) goto LA3;
if ((NU)(0) > (NU)(Ext_37670->Sup.len)) raiseIndexError();
LOC2 = ((NU8)(Ext_37670->data[0]) == (NU8)(46));
LA3: ;
if (!LOC2) goto LA4;
F.line = 419;F.filename = "os.nim";
Result_37671 = copyString(Ext_37670);
goto LA1;
LA4: ;
F.line = 420;F.filename = "os.nim";
LOC6 = 0;
LOC6 = rawNewString(Ext_37670->Sup.len + 1);
appendChar(LOC6, 46);
appendString(LOC6, Ext_37670);
Result_37671 = LOC6;
LA1: ;
framePtr = framePtr->prev;
return Result_37671;
}
N_NIMCALL(NimStringDesc*, nosChangeFileExt)(NimStringDesc* Filename_38020, NimStringDesc* Ext_38021) {
NimStringDesc* Result_38022;
NI Extpos_38023;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
NimStringDesc* LOC6;
NimStringDesc* LOC7;
NimStringDesc* LOC8;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "ChangeFileExt";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_38022 = 0;
Extpos_38023 = 0;
F.line = 533;F.filename = "os.nim";
Extpos_38023 = Searchextpos_37678(Filename_38020);
F.line = 534;F.filename = "os.nim";
if (!(Extpos_38023 < 0)) goto LA2;
F.line = 534;F.filename = "os.nim";
LOC4 = 0;
LOC5 = 0;
LOC5 = Normext_37668(Ext_38021);
LOC4 = rawNewString(Filename_38020->Sup.len + LOC5->Sup.len + 0);
appendString(LOC4, Filename_38020);
appendString(LOC4, LOC5);
Result_38022 = LOC4;
goto LA1;
LA2: ;
F.line = 535;F.filename = "os.nim";
LOC6 = 0;
LOC7 = 0;
LOC7 = copyStrLast(Filename_38020, 0, subInt(Extpos_38023, 1));
LOC8 = 0;
LOC8 = Normext_37668(Ext_38021);
LOC6 = rawNewString(LOC7->Sup.len + LOC8->Sup.len + 0);
appendString(LOC6, LOC7);
appendString(LOC6, LOC8);
Result_38022 = LOC6;
LA1: ;
framePtr = framePtr->prev;
return Result_38022;
}
N_NIMCALL(void, nosSplitPath)(NimStringDesc* Path_37577, TY37578* Result) {
NI Seppos_37582;
NI I_37592;
NI HEX3Atmp_37608;
NI Res_37610;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "SplitPath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
memset((void*)Result, 0, sizeof((*Result)));
Seppos_37582 = 0;
F.line = 380;F.filename = "os.nim";
Seppos_37582 = -1;
I_37592 = 0;
HEX3Atmp_37608 = 0;
F.line = 381;F.filename = "os.nim";
HEX3Atmp_37608 = subInt(Path_37577->Sup.len, 1);
Res_37610 = 0;
F.line = 1012;F.filename = "system.nim";
Res_37610 = HEX3Atmp_37608;
F.line = 1013;F.filename = "system.nim";
while (1) {
if (!(0 <= Res_37610)) goto LA1;
F.line = 1012;F.filename = "system.nim";
I_37592 = Res_37610;
F.line = 382;F.filename = "os.nim";
if ((NU)(I_37592) > (NU)(Path_37577->Sup.len)) raiseIndexError();
if (!(((NU8)(Path_37577->data[I_37592])) == ((NU8)(47)) || ((NU8)(Path_37577->data[I_37592])) == ((NU8)(47)))) goto LA3;
F.line = 383;F.filename = "os.nim";
Seppos_37582 = I_37592;
F.line = 384;F.filename = "os.nim";
goto LA1;
LA3: ;
F.line = 1015;F.filename = "system.nim";
Res_37610 = subInt(Res_37610, 1);
} LA1: ;
F.line = 385;F.filename = "os.nim";
if (!(0 <= Seppos_37582)) goto LA6;
F.line = 386;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Head, copyStrLast(Path_37577, 0, subInt(Seppos_37582, 1)));
F.line = 387;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Tail, copyStr(Path_37577, addInt(Seppos_37582, 1)));
goto LA5;
LA6: ;
F.line = 389;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Head, copyString(((NimStringDesc*) &TMP44351)));
F.line = 390;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Tail, copyString(Path_37577));
LA5: ;
framePtr = framePtr->prev;
}
N_NIMCALL(void, nossplitFile)(NimStringDesc* Path_37714, TY37715* Result) {
NIM_BOOL LOC2;
NI Seppos_37739;
NI Dotpos_37742;
NI I_37752;
NI HEX3Atmp_37774;
NI Res_37776;
NIM_BOOL LOC11;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "splitFile";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
memset((void*)Result, 0, sizeof((*Result)));
F.line = 449;F.filename = "os.nim";
LOC2 = (Path_37714->Sup.len == 0);
if (LOC2) goto LA3;
if ((NU)(subInt(Path_37714->Sup.len, 1)) > (NU)(Path_37714->Sup.len)) raiseIndexError();
LOC2 = (((NU8)(Path_37714->data[subInt(Path_37714->Sup.len, 1)])) == ((NU8)(47)) || ((NU8)(Path_37714->data[subInt(Path_37714->Sup.len, 1)])) == ((NU8)(47)));
LA3: ;
if (!LOC2) goto LA4;
F.line = 450;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Dir, copyString(Path_37714));
unsureAsgnRef((void**) &(*Result).Name, copyString(((NimStringDesc*) &TMP44351)));
unsureAsgnRef((void**) &(*Result).Ext, copyString(((NimStringDesc*) &TMP44351)));
goto LA1;
LA4: ;
Seppos_37739 = 0;
F.line = 452;F.filename = "os.nim";
Seppos_37739 = -1;
Dotpos_37742 = 0;
F.line = 453;F.filename = "os.nim";
Dotpos_37742 = Path_37714->Sup.len;
I_37752 = 0;
HEX3Atmp_37774 = 0;
F.line = 454;F.filename = "os.nim";
HEX3Atmp_37774 = subInt(Path_37714->Sup.len, 1);
Res_37776 = 0;
F.line = 1012;F.filename = "system.nim";
Res_37776 = HEX3Atmp_37774;
F.line = 1013;F.filename = "system.nim";
while (1) {
if (!(0 <= Res_37776)) goto LA6;
F.line = 1012;F.filename = "system.nim";
I_37752 = Res_37776;
F.line = 455;F.filename = "os.nim";
if ((NU)(I_37752) > (NU)(Path_37714->Sup.len)) raiseIndexError();
if (!((NU8)(Path_37714->data[I_37752]) == (NU8)(46))) goto LA8;
F.line = 456;F.filename = "os.nim";
LOC11 = (Dotpos_37742 == Path_37714->Sup.len);
if (!(LOC11)) goto LA12;
LOC11 = (0 < I_37752);
LA12: ;
if (!LOC11) goto LA13;
F.line = 456;F.filename = "os.nim";
Dotpos_37742 = I_37752;
LA13: ;
goto LA7;
LA8: ;
if ((NU)(I_37752) > (NU)(Path_37714->Sup.len)) raiseIndexError();
if (!(((NU8)(Path_37714->data[I_37752])) == ((NU8)(47)) || ((NU8)(Path_37714->data[I_37752])) == ((NU8)(47)))) goto LA15;
F.line = 458;F.filename = "os.nim";
Seppos_37739 = I_37752;
F.line = 459;F.filename = "os.nim";
goto LA6;
goto LA7;
LA15: ;
LA7: ;
F.line = 1015;F.filename = "system.nim";
Res_37776 = subInt(Res_37776, 1);
} LA6: ;
F.line = 460;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Dir, copyStrLast(Path_37714, 0, subInt(Seppos_37739, 1)));
F.line = 461;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Name, copyStrLast(Path_37714, addInt(Seppos_37739, 1), subInt(Dotpos_37742, 1)));
F.line = 462;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Ext, copyStr(Path_37714, Dotpos_37742));
LA1: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, Getapplaux_40801)(NimStringDesc* Procpath_40803) {
NimStringDesc* Result_40804;
NI Len_40805;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getApplAux";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_40804 = 0;
F.line = 1157;F.filename = "os.nim";
Result_40804 = mnewString(256);
Len_40805 = 0;
F.line = 1158;F.filename = "os.nim";
Len_40805 = readlink(Procpath_40803->data, Result_40804->data, 256);
F.line = 1159;F.filename = "os.nim";
if (!(256 < Len_40805)) goto LA2;
F.line = 1160;F.filename = "os.nim";
Result_40804 = mnewString(addInt(Len_40805, 1));
F.line = 1161;F.filename = "os.nim";
Len_40805 = readlink(Procpath_40803->data, Result_40804->data, Len_40805);
LA2: ;
F.line = 1162;F.filename = "os.nim";
Result_40804 = setLengthStr(Result_40804, Len_40805);
framePtr = framePtr->prev;
return Result_40804;
}
N_NIMCALL(NimStringDesc*, nosgetApplicationFilename)(void) {
NimStringDesc* Result_41203;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getApplicationFilename";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_41203 = 0;
F.line = 1186;F.filename = "os.nim";
Result_41203 = Getapplaux_40801(((NimStringDesc*) &TMP45197));
framePtr = framePtr->prev;
return Result_41203;
}
N_NIMCALL(NimStringDesc*, nosgetApplicationDir)(void) {
NimStringDesc* Result_41403;
NimStringDesc* LOC1;
TY37715 LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getApplicationDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_41403 = 0;
F.line = 1211;F.filename = "os.nim";
LOC1 = 0;
LOC1 = nosgetApplicationFilename();
memset((void*)&LOC2, 0, sizeof(LOC2));
nossplitFile(LOC1, &LOC2);
Result_41403 = copyString(LOC2.Dir);
framePtr = framePtr->prev;
return Result_41403;
}
N_NOINLINE(void, nosOSError)(NimStringDesc* Msg_35604) {
TY422* E_35804;
NCSTRING LOC8;
TY422* E_35821;
TY422* E_35838;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "OSError";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 156;F.filename = "os.nim";
if (!(Msg_35604->Sup.len == 0)) goto LA2;
F.line = 168;F.filename = "os.nim";
if (!!((errno == ((NI32) 0)))) goto LA5;
E_35804 = 0;
F.line = 1280;F.filename = "system.nim";
E_35804 = (TY422*) newObj(NTI35803, sizeof(TY422));
(*E_35804).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1281;F.filename = "system.nim";
LOC8 = strerror(errno);
asgnRefNoCycle((void**) &(*E_35804).Sup.Sup.Sup.message, cstrToNimstr(LOC8));
F.line = 169;F.filename = "os.nim";
raiseException((E_Base*)E_35804, "EOS");
goto LA4;
LA5: ;
E_35821 = 0;
F.line = 1280;F.filename = "system.nim";
E_35821 = (TY422*) newObj(NTI35803, sizeof(TY422));
(*E_35821).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1281;F.filename = "system.nim";
asgnRefNoCycle((void**) &(*E_35821).Sup.Sup.Sup.message, copyString(((NimStringDesc*) &TMP45221)));
F.line = 171;F.filename = "os.nim";
raiseException((E_Base*)E_35821, "EOS");
LA4: ;
goto LA1;
LA2: ;
E_35838 = 0;
F.line = 1280;F.filename = "system.nim";
E_35838 = (TY422*) newObj(NTI35803, sizeof(TY422));
(*E_35838).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1281;F.filename = "system.nim";
asgnRefNoCycle((void**) &(*E_35838).Sup.Sup.Sup.message, copyString(Msg_35604));
F.line = 173;F.filename = "os.nim";
raiseException((E_Base*)E_35838, "EOS");
LA1: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nosgetCurrentDir)(void) {
NimStringDesc* Result_37010;
NCSTRING LOC2;
NI LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getCurrentDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37010 = 0;
F.line = 289;F.filename = "os.nim";
Result_37010 = mnewString(512);
F.line = 295;F.filename = "os.nim";
LOC2 = getcwd(Result_37010->data, 512);
if (!!((LOC2 == NIM_NIL))) goto LA3;
F.line = 296;F.filename = "os.nim";
LOC5 = strlen(Result_37010->data);
Result_37010 = setLengthStr(Result_37010, LOC5);
goto LA1;
LA3: ;
F.line = 298;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP44351));
LA1: ;
framePtr = framePtr->prev;
return Result_37010;
}
N_NIMCALL(NimStringDesc*, nosJoinPath)(NimStringDesc* Head_37403, NimStringDesc* Tail_37404) {
NimStringDesc* Result_37405;
NimStringDesc* LOC9;
NimStringDesc* LOC10;
NimStringDesc* LOC11;
NimStringDesc* LOC15;
NimStringDesc* LOC16;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "JoinPath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37405 = 0;
F.line = 324;F.filename = "os.nim";
if (!(Head_37403->Sup.len == 0)) goto LA2;
F.line = 325;F.filename = "os.nim";
Result_37405 = copyString(Tail_37404);
goto LA1;
LA2: ;
if ((NU)(subInt(Head_37403->Sup.len, 1)) > (NU)(Head_37403->Sup.len)) raiseIndexError();
if (!(((NU8)(Head_37403->data[subInt(Head_37403->Sup.len, 1)])) == ((NU8)(47)) || ((NU8)(Head_37403->data[subInt(Head_37403->Sup.len, 1)])) == ((NU8)(47)))) goto LA4;
F.line = 327;F.filename = "os.nim";
if ((NU)(0) > (NU)(Tail_37404->Sup.len)) raiseIndexError();
if (!(((NU8)(Tail_37404->data[0])) == ((NU8)(47)) || ((NU8)(Tail_37404->data[0])) == ((NU8)(47)))) goto LA7;
F.line = 328;F.filename = "os.nim";
LOC9 = 0;
LOC10 = 0;
LOC10 = copyStr(Tail_37404, 1);
LOC9 = rawNewString(Head_37403->Sup.len + LOC10->Sup.len + 0);
appendString(LOC9, Head_37403);
appendString(LOC9, LOC10);
Result_37405 = LOC9;
goto LA6;
LA7: ;
F.line = 330;F.filename = "os.nim";
LOC11 = 0;
LOC11 = rawNewString(Head_37403->Sup.len + Tail_37404->Sup.len + 0);
appendString(LOC11, Head_37403);
appendString(LOC11, Tail_37404);
Result_37405 = LOC11;
LA6: ;
goto LA1;
LA4: ;
F.line = 332;F.filename = "os.nim";
if ((NU)(0) > (NU)(Tail_37404->Sup.len)) raiseIndexError();
if (!(((NU8)(Tail_37404->data[0])) == ((NU8)(47)) || ((NU8)(Tail_37404->data[0])) == ((NU8)(47)))) goto LA13;
F.line = 333;F.filename = "os.nim";
LOC15 = 0;
LOC15 = rawNewString(Head_37403->Sup.len + Tail_37404->Sup.len + 0);
appendString(LOC15, Head_37403);
appendString(LOC15, Tail_37404);
Result_37405 = LOC15;
goto LA12;
LA13: ;
F.line = 335;F.filename = "os.nim";
LOC16 = 0;
LOC16 = rawNewString(Head_37403->Sup.len + Tail_37404->Sup.len + 1);
appendString(LOC16, Head_37403);
appendChar(LOC16, 47);
appendString(LOC16, Tail_37404);
Result_37405 = LOC16;
LA12: ;
LA1: ;
framePtr = framePtr->prev;
return Result_37405;
}
N_NIMCALL(NimStringDesc*, nosJoinPathOpenArray)(NimStringDesc** Parts_37487, NI Parts_37487Len0) {
NimStringDesc* Result_37488;
NI I_37511;
NI HEX3Atmp_37513;
NI Res_37515;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "JoinPath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37488 = 0;
F.line = 341;F.filename = "os.nim";
if ((NU)(0) >= (NU)(Parts_37487Len0)) raiseIndexError();
Result_37488 = copyString(Parts_37487[0]);
I_37511 = 0;
HEX3Atmp_37513 = 0;
F.line = 342;F.filename = "os.nim";
HEX3Atmp_37513 = (Parts_37487Len0-1);
Res_37515 = 0;
F.line = 1021;F.filename = "system.nim";
Res_37515 = 1;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_37515 <= HEX3Atmp_37513)) goto LA1;
F.line = 1021;F.filename = "system.nim";
I_37511 = Res_37515;
F.line = 343;F.filename = "os.nim";
if ((NU)(I_37511) >= (NU)(Parts_37487Len0)) raiseIndexError();
Result_37488 = nosJoinPath(Result_37488, Parts_37487[I_37511]);
F.line = 1024;F.filename = "system.nim";
Res_37515 = addInt(Res_37515, 1);
} LA1: ;
framePtr = framePtr->prev;
return Result_37488;
}
N_NIMCALL(void, Rawcreatedir_39423)(NimStringDesc* Dir_39425) {
NIM_BOOL LOC2;
int LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "rawCreateDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 914;F.filename = "os.nim";
LOC3 = mkdir(Dir_39425->data, 457);
LOC2 = !((LOC3 == ((NI32) 0)));
if (!(LOC2)) goto LA4;
LOC2 = !((errno == EEXIST));
LA4: ;
if (!LOC2) goto LA5;
F.line = 915;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP44351));
LA5: ;
framePtr = framePtr->prev;
}
N_NIMCALL(void, noscreateDir)(NimStringDesc* Dir_39603) {
NI I_39613;
NI HEX3Atmp_39627;
NI Res_39629;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "createDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
I_39613 = 0;
HEX3Atmp_39627 = 0;
F.line = 927;F.filename = "os.nim";
HEX3Atmp_39627 = subInt(Dir_39603->Sup.len, 1);
Res_39629 = 0;
F.line = 1021;F.filename = "system.nim";
Res_39629 = 1;
F.line = 1022;F.filename = "system.nim";
while (1) {
if (!(Res_39629 <= HEX3Atmp_39627)) goto LA1;
F.line = 1021;F.filename = "system.nim";
I_39613 = Res_39629;
F.line = 928;F.filename = "os.nim";
if ((NU)(I_39613) > (NU)(Dir_39603->Sup.len)) raiseIndexError();
if (!(((NU8)(Dir_39603->data[I_39613])) == ((NU8)(47)) || ((NU8)(Dir_39603->data[I_39613])) == ((NU8)(47)))) goto LA3;
F.line = 928;F.filename = "os.nim";
LOC5 = 0;
LOC5 = copyStrLast(Dir_39603, 0, subInt(I_39613, 1));
Rawcreatedir_39423(LOC5);
LA3: ;
F.line = 1024;F.filename = "system.nim";
Res_39629 = addInt(Res_39629, 1);
} LA1: ;
F.line = 929;F.filename = "os.nim";
Rawcreatedir_39423(Dir_39603);
framePtr = framePtr->prev;
}
N_NIMCALL(NIM_BOOL, nosexistsFile)(NimStringDesc* Filename_36003) {
NIM_BOOL Result_36004;
struct stat Res_36005;
NIM_BOOL LOC1;
int LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "existsFile";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_36004 = 0;
memset((void*)&Res_36005, 0, sizeof(Res_36005));
F.line = 229;F.filename = "os.nim";
F.line = 229;F.filename = "os.nim";
LOC2 = stat(Filename_36003->data, &Res_36005);
LOC1 = (((NI32) 0) <= LOC2);
if (!(LOC1)) goto LA3;
LOC1 = S_ISREG(Res_36005.st_mode);
LA3: ;
Result_36004 = LOC1;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_36004;
}
N_NIMCALL(NimStringDesc*, nosextractFilename)(NimStringDesc* Path_37785) {
NimStringDesc* Result_37786;
NIM_BOOL LOC2;
TY37578 LOC6;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "extractFilename";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37786 = 0;
F.line = 475;F.filename = "os.nim";
LOC2 = (Path_37785->Sup.len == 0);
if (LOC2) goto LA3;
if ((NU)(subInt(Path_37785->Sup.len, 1)) > (NU)(Path_37785->Sup.len)) raiseIndexError();
LOC2 = (((NU8)(Path_37785->data[subInt(Path_37785->Sup.len, 1)])) == ((NU8)(47)) || ((NU8)(Path_37785->data[subInt(Path_37785->Sup.len, 1)])) == ((NU8)(47)));
LA3: ;
if (!LOC2) goto LA4;
F.line = 476;F.filename = "os.nim";
Result_37786 = copyString(((NimStringDesc*) &TMP44351));
goto LA1;
LA4: ;
F.line = 478;F.filename = "os.nim";
memset((void*)&LOC6, 0, sizeof(LOC6));
nosSplitPath(Path_37785, &LOC6);
Result_37786 = copyString(LOC6.Tail);
LA1: ;
framePtr = framePtr->prev;
return Result_37786;
}
N_NIMCALL(TY4377*, nosparseCmdLine)(NimStringDesc* C_39634) {
TY4377* Result_39636;
NI I_39653;
NimStringDesc* A_39654;
NIM_BOOL LOC3;
NIM_CHAR Delim_39671;
NIM_BOOL LOC6;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "parseCmdLine";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_39636 = 0;
F.line = 962;F.filename = "os.nim";
Result_39636 = (TY4377*) newSeq(NTI4377, 0);
I_39653 = 0;
F.line = 963;F.filename = "os.nim";
I_39653 = 0;
A_39654 = 0;
F.line = 964;F.filename = "os.nim";
A_39654 = copyString(((NimStringDesc*) &TMP44351));
F.line = 965;F.filename = "os.nim";
while (1) {
F.line = 966;F.filename = "os.nim";
A_39654 = setLengthStr(A_39654, 0);
F.line = 967;F.filename = "os.nim";
while (1) {
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
LOC3 = ((NU8)(C_39634->data[I_39653]) == (NU8)(32));
if (LOC3) goto LA4;
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
LOC3 = ((NU8)(C_39634->data[I_39653]) == (NU8)(9));
LA4: ;
if (!LOC3) goto LA2;
F.line = 967;F.filename = "os.nim";
I_39653 = addInt(I_39653, 1);
} LA2: ;
F.line = 1005;F.filename = "os.nim";
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
switch (((NU8)(C_39634->data[I_39653]))) {
case 39:
case 34:
Delim_39671 = 0;
F.line = 1007;F.filename = "os.nim";
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
Delim_39671 = C_39634->data[I_39653];
F.line = 1008;F.filename = "os.nim";
I_39653 = addInt(I_39653, 1);
F.line = 1009;F.filename = "os.nim";
while (1) {
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
LOC6 = !(((NU8)(C_39634->data[I_39653]) == (NU8)(0)));
if (!(LOC6)) goto LA7;
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
LOC6 = !(((NU8)(C_39634->data[I_39653]) == (NU8)(Delim_39671)));
LA7: ;
if (!LOC6) goto LA5;
F.line = 1010;F.filename = "os.nim";
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
A_39654 = addChar(A_39654, C_39634->data[I_39653]);
F.line = 1011;F.filename = "os.nim";
I_39653 = addInt(I_39653, 1);
} LA5: ;
F.line = 1012;F.filename = "os.nim";
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
if (!!(((NU8)(C_39634->data[I_39653]) == (NU8)(0)))) goto LA9;
F.line = 1012;F.filename = "os.nim";
I_39653 = addInt(I_39653, 1);
LA9: ;
break;
case 0:
F.line = 1013;F.filename = "os.nim";
goto LA1;
break;
default:
F.line = 1015;F.filename = "os.nim";
while (1) {
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
if (!((NU8)(32) < (NU8)(C_39634->data[I_39653]))) goto LA11;
F.line = 1016;F.filename = "os.nim";
if ((NU)(I_39653) > (NU)(C_39634->Sup.len)) raiseIndexError();
A_39654 = addChar(A_39654, C_39634->data[I_39653]);
F.line = 1017;F.filename = "os.nim";
I_39653 = addInt(I_39653, 1);
} LA11: ;
break;
}
F.line = 1018;F.filename = "os.nim";
Result_39636 = (TY4377*) incrSeq(&(Result_39636)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &Result_39636->data[Result_39636->Sup.len-1], copyString(A_39654));
} LA1: ;
framePtr = framePtr->prev;
return Result_39636;
}
static N_INLINE(NI, divInt)(NI A_6403, NI B_6404) {
NI Result_6405;
NIM_BOOL LOC5;
Result_6405 = 0;
if (!(B_6404 == 0)) goto LA2;
raiseDivByZero();
LA2: ;
LOC5 = (A_6403 == (IL64(-9223372036854775807) - IL64(1)));
if (!(LOC5)) goto LA6;
LOC5 = (B_6404 == -1);
LA6: ;
if (!LOC5) goto LA7;
raiseOverflow();
LA7: ;
Result_6405 = (NI64)(A_6403 / B_6404);
goto BeforeRet;
BeforeRet: ;
return Result_6405;
}
static N_INLINE(NI, modInt)(NI A_6603, NI B_6604) {
NI Result_6605;
Result_6605 = 0;
if (!(B_6604 == 0)) goto LA2;
raiseDivByZero();
LA2: ;
Result_6605 = (NI64)(A_6603 % B_6604);
goto BeforeRet;
BeforeRet: ;
return Result_6605;
}
N_NIMCALL(void, nossleep)(NI Milsecs_41406) {
struct timespec A_41407;
struct timespec B_41408;
int LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "sleep";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
memset((void*)&A_41407, 0, sizeof(A_41407));
memset((void*)&B_41408, 0, sizeof(B_41408));
F.line = 1219;F.filename = "os.nim";
A_41407.tv_sec = ((NI) (divInt(Milsecs_41406, 1000)));
F.line = 1220;F.filename = "os.nim";
A_41407.tv_nsec = mulInt(modInt(Milsecs_41406, 1000), 1000);
F.line = 1221;F.filename = "os.nim";
LOC1 = nanosleep(&A_41407, &B_41408);
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, HEX2F_37518)(NimStringDesc* Head_37520, NimStringDesc* Tail_37521) {
NimStringDesc* Result_37522;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "/";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37522 = 0;
F.line = 347;F.filename = "os.nim";
F.line = 347;F.filename = "os.nim";
Result_37522 = nosJoinPath(Head_37520, Tail_37521);
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_37522;
}
N_NIMCALL(NimStringDesc*, nosaddFileExt)(NimStringDesc* Filename_38044, NimStringDesc* Ext_38045) {
NimStringDesc* Result_38046;
NI Extpos_38047;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "addFileExt";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_38046 = 0;
Extpos_38047 = 0;
F.line = 545;F.filename = "os.nim";
Extpos_38047 = Searchextpos_37678(Filename_38044);
F.line = 546;F.filename = "os.nim";
if (!(Extpos_38047 < 0)) goto LA2;
F.line = 546;F.filename = "os.nim";
LOC4 = 0;
LOC5 = 0;
LOC5 = Normext_37668(Ext_38045);
LOC4 = rawNewString(Filename_38044->Sup.len + LOC5->Sup.len + 0);
appendString(LOC4, Filename_38044);
appendString(LOC4, LOC5);
Result_38046 = LOC4;
goto LA1;
LA2: ;
F.line = 547;F.filename = "os.nim";
Result_38046 = copyString(Filename_38044);
LA1: ;
framePtr = framePtr->prev;
return Result_38046;
}
N_NIMCALL(NimStringDesc*, nosUnixToNativePath)(NimStringDesc* Path_35856) {
NimStringDesc* Result_35857;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "UnixToNativePath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_35857 = 0;
F.line = 182;F.filename = "os.nim";
Result_35857 = copyString(Path_35856);
framePtr = framePtr->prev;
return Result_35857;
}
N_NIMCALL(void, Putenv_38639)(NimStringDesc* Key_38641, NimStringDesc* Val_38642) {
NI Indx_38643;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
int LOC7;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "putEnv";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Indx_38643 = 0;
F.line = 754;F.filename = "os.nim";
Indx_38643 = Findenvvar_38602(Key_38641);
F.line = 755;F.filename = "os.nim";
if (!(0 <= Indx_38643)) goto LA2;
F.line = 756;F.filename = "os.nim";
if ((NU)(Indx_38643) >= (NU)(Environment_38439->Sup.len)) raiseIndexError();
LOC4 = 0;
LOC4 = rawNewString(Key_38641->Sup.len + Val_38642->Sup.len + 1);
appendString(LOC4, Key_38641);
appendChar(LOC4, 61);
appendString(LOC4, Val_38642);
asgnRefNoCycle((void**) &Environment_38439->data[Indx_38643], LOC4);
goto LA1;
LA2: ;
F.line = 758;F.filename = "os.nim";
LOC5 = 0;
LOC5 = rawNewString(Key_38641->Sup.len + Val_38642->Sup.len + 1);
appendString(LOC5, Key_38641);
appendChar(LOC5, 61);
appendString(LOC5, Val_38642);
Environment_38439 = (TY4377*) incrSeq(&(Environment_38439)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &Environment_38439->data[Environment_38439->Sup.len-1], copyString(LOC5));
F.line = 759;F.filename = "os.nim";
Indx_38643 = (Environment_38439->Sup.len-1);
LA1: ;
F.line = 761;F.filename = "os.nim";
if ((NU)(Indx_38643) >= (NU)(Environment_38439->Sup.len)) raiseIndexError();
LOC7 = putenv(Environment_38439->data[Indx_38643]->data);
if (!!((LOC7 == ((NI32) 0)))) goto LA8;
F.line = 762;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP44351));
LA8: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nosgetConfigDir)(void) {
NimStringDesc* Result_40403;
NimStringDesc* LOC1;
NimStringDesc* LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getConfigDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_40403 = 0;
F.line = 1117;F.filename = "os.nim";
F.line = 1117;F.filename = "os.nim";
LOC1 = 0;
LOC2 = 0;
LOC2 = Getenv_38625(((NimStringDesc*) &TMP78535));
LOC1 = rawNewString(LOC2->Sup.len + 9);
appendString(LOC1, LOC2);
appendString(LOC1, ((NimStringDesc*) &TMP78536));
Result_40403 = LOC1;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_40403;
}
N_NIMCALL(NI, noscmpPaths)(NimStringDesc* Patha_38065, NimStringDesc* Pathb_38066) {
NI Result_38067;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "cmpPaths";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_38067 = 0;
F.line = 564;F.filename = "os.nim";
if (!NIM_TRUE) goto LA2;
F.line = 565;F.filename = "os.nim";
Result_38067 = Cmp_1321(Patha_38065, Pathb_38066);
goto LA1;
LA2: ;
F.line = 567;F.filename = "os.nim";
Result_38067 = nsuCmpIgnoreCase(Patha_38065, Pathb_38066);
LA1: ;
framePtr = framePtr->prev;
return Result_38067;
}
N_NIMCALL(NIM_BOOL, nossameFile)(NimStringDesc* Path1_38070, NimStringDesc* Path2_38071) {
NIM_BOOL Result_38072;
struct stat A_38073;
struct stat B_38074;
NIM_BOOL LOC2;
int LOC3;
int LOC5;
NI LOC8;
NIM_BOOL LOC9;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "sameFile";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_38072 = 0;
memset((void*)&A_38073, 0, sizeof(A_38073));
memset((void*)&B_38074, 0, sizeof(B_38074));
F.line = 588;F.filename = "os.nim";
LOC3 = stat(Path1_38070->data, &A_38073);
LOC2 = (LOC3 < ((NI32) 0));
if (LOC2) goto LA4;
LOC5 = stat(Path2_38071->data, &B_38074);
LOC2 = (LOC5 < ((NI32) 0));
LA4: ;
if (!LOC2) goto LA6;
F.line = 589;F.filename = "os.nim";
LOC8 = noscmpPaths(Path1_38070, Path2_38071);
Result_38072 = (LOC8 == 0);
goto LA1;
LA6: ;
F.line = 591;F.filename = "os.nim";
LOC9 = (A_38073.st_dev == B_38074.st_dev);
if (!(LOC9)) goto LA10;
LOC9 = (A_38073.st_ino == B_38074.st_ino);
LA10: ;
Result_38072 = LOC9;
LA1: ;
framePtr = framePtr->prev;
return Result_38072;
}
N_NIMCALL(NI, nosgetLastModificationTime)(NimStringDesc* File_36403) {
NI Result_36404;
struct stat Res_36405;
int LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getLastModificationTime";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_36404 = 0;
memset((void*)&Res_36405, 0, sizeof(Res_36405));
F.line = 246;F.filename = "os.nim";
LOC2 = stat(File_36403->data, &Res_36405);
if (!(LOC2 < ((NI32) 0))) goto LA3;
F.line = 246;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP44351));
LA3: ;
F.line = 247;F.filename = "os.nim";
F.line = 247;F.filename = "os.nim";
Result_36404 = Res_36405.st_mtime;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_36404;
}
N_NIMCALL(NIM_BOOL, nosfileNewer)(NimStringDesc* A_37003, NimStringDesc* B_37004) {
NIM_BOOL Result_37005;
NI LOC1;
NI LOC2;
NI64 LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "fileNewer";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_37005 = 0;
F.line = 284;F.filename = "os.nim";
LOC1 = nosgetLastModificationTime(A_37003);
LOC2 = nosgetLastModificationTime(B_37004);
LOC3 = ntDiffTime(LOC1, LOC2);
Result_37005 = (0 < LOC3);
framePtr = framePtr->prev;
return Result_37005;
}
N_NIMCALL(NI, Paramcount_40628)(void) {
NI Result_40630;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "paramCount";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_40630 = 0;
F.line = 1153;F.filename = "os.nim";
F.line = 1153;F.filename = "os.nim";
Result_40630 = subInt(((NI) (cmdCount)), 1);
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_40630;
}
N_NIMCALL(NimStringDesc*, Paramstr_40603)(NI I_40605) {
NimStringDesc* Result_40606;
NIM_BOOL LOC2;
TY444* E_40612;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "paramStr";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_40606 = 0;
F.line = 1150;F.filename = "os.nim";
LOC2 = (I_40605 < ((NI) (cmdCount)));
if (!(LOC2)) goto LA3;
LOC2 = (0 <= I_40605);
LA3: ;
if (!LOC2) goto LA4;
F.line = 1150;F.filename = "os.nim";
F.line = 1150;F.filename = "os.nim";
if ((NU)(I_40605) > (NU)(50000)) raiseIndexError();
Result_40606 = cstrToNimstr(cmdLine[(I_40605)-0]);
goto BeforeRet;
LA4: ;
E_40612 = 0;
F.line = 1280;F.filename = "system.nim";
E_40612 = (TY444*) newObj(NTI5456, sizeof(TY444));
(*E_40612).Sup.Sup.Sup.m_type = NTI444;
F.line = 1281;F.filename = "system.nim";
asgnRefNoCycle((void**) &(*E_40612).Sup.Sup.message, copyString(((NimStringDesc*) &TMP194612)));
F.line = 1151;F.filename = "os.nim";
raiseException((E_Base*)E_40612, "EInvalidIndex");
BeforeRet: ;
framePtr = framePtr->prev;
return Result_40606;
}
N_NOINLINE(void, osInit)(void) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "os";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 682;F.filename = "os.nim";
Envcomputed_38421 = NIM_FALSE;
F.line = 683;F.filename = "os.nim";
asgnRefNoCycle((void**) &Environment_38439, (TY4377*) newSeq(NTI4377, 0));
framePtr = framePtr->prev;
}

